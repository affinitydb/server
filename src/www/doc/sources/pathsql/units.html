<head>
  <link href='../../css/ksdoc.css' rel='stylesheet' type='text/css' />
  <link href='../../css/source.css' rel='stylesheet' type='text/css' />
</head>
<div id="units_sql">
<h1>units.sql</h1>

<!-- begin highlighted code -->
<pre>
DROP STORE TEST1;
OPEN STORE TEST1;

--- integer with suffix will be converted to float/double automatically
EXECUTE EXPRESSION as 1m;

-- list all units of measurement in a value
EXECUTE EXPRESSION as 1.1m;			
EXECUTE EXPRESSION as 1.1kg;		
EXECUTE EXPRESSION as 1.1s;			
EXECUTE EXPRESSION as 1.1A;			
EXECUTE EXPRESSION as 1.1K;			
EXECUTE EXPRESSION as 1.1mol;		
EXECUTE EXPRESSION as 1.1cd;		

EXECUTE EXPRESSION as 1.1Hz;		
EXECUTE EXPRESSION as 1.1N;			
EXECUTE EXPRESSION as 1.1Pa;		
EXECUTE EXPRESSION as 1.1J;			
EXECUTE EXPRESSION as 1.1W;			
EXECUTE EXPRESSION as 1.1C;			
EXECUTE EXPRESSION as 1.1V;			
EXECUTE EXPRESSION as 1.1F;			
EXECUTE EXPRESSION as 1.1Ohm;		
EXECUTE EXPRESSION as 1.1S;			
EXECUTE EXPRESSION as 1.1Wb;		
EXECUTE EXPRESSION as 1.1T;			
EXECUTE EXPRESSION as 1.1H;			
EXECUTE EXPRESSION as 1.1dC;		
EXECUTE EXPRESSION as 1.1rad;		
EXECUTE EXPRESSION as 1.1sr;		
EXECUTE EXPRESSION as 1.1lm;		
EXECUTE EXPRESSION as 1.1lx;		
EXECUTE EXPRESSION as 1.1Bq;		
EXECUTE EXPRESSION as 1.1Gy;		
EXECUTE EXPRESSION as 1.1Sv;		
EXECUTE EXPRESSION as 1.1kat;		

EXECUTE EXPRESSION as 1.1dm;		
EXECUTE EXPRESSION as 1.1cm;		
EXECUTE EXPRESSION as 1.1mm;		
EXECUTE EXPRESSION as 1.1mkm;		
EXECUTE EXPRESSION as 1.1nm;		
EXECUTE EXPRESSION as 1.1km;		
EXECUTE EXPRESSION as 1.1in;		
EXECUTE EXPRESSION as 1.1ft;		
EXECUTE EXPRESSION as 1.1yd;		
EXECUTE EXPRESSION as 1.1mi;		
EXECUTE EXPRESSION as 1.1nmi;		

EXECUTE EXPRESSION as 1.1au;			
EXECUTE EXPRESSION as 1.1pc;			
EXECUTE EXPRESSION as 1.1ly;			

EXECUTE EXPRESSION as 1.1mps;			
EXECUTE EXPRESSION as 1.1kph;			
EXECUTE EXPRESSION as 1.1fpm;			
EXECUTE EXPRESSION as 1.1mph;			
EXECUTE EXPRESSION as 1.1kt;			

EXECUTE EXPRESSION as 1.1g;				
EXECUTE EXPRESSION as 1.1mg;			
EXECUTE EXPRESSION as 1.1mkg;			
EXECUTE EXPRESSION as 1.1t;				

EXECUTE EXPRESSION as 1.1lb;			
EXECUTE EXPRESSION as 1.1oz;			
EXECUTE EXPRESSION as 1.1st;			

EXECUTE EXPRESSION as 1.1m2;			
EXECUTE EXPRESSION as 1.1cm2;			
EXECUTE EXPRESSION as 1.1sqin;			
EXECUTE EXPRESSION as 1.1sqft;			
EXECUTE EXPRESSION as 1.1ac;			
EXECUTE EXPRESSION as 1.1ha;			

EXECUTE EXPRESSION as 1.1m3;			
EXECUTE EXPRESSION as 1.1l;				
EXECUTE EXPRESSION as 1.1cl;			
EXECUTE EXPRESSION as 1.1cm3;			
EXECUTE EXPRESSION as 1.1cf;			
EXECUTE EXPRESSION as 1.1ci;			
EXECUTE EXPRESSION as 1.1floz;			

EXECUTE EXPRESSION as 1.1bbl;			
EXECUTE EXPRESSION as 1.1bu;			
EXECUTE EXPRESSION as 1.1gal;			
EXECUTE EXPRESSION as 1.1qt;			
EXECUTE EXPRESSION as 1.1pt;			

EXECUTE EXPRESSION as 1.1b;				
EXECUTE EXPRESSION as 1.1mmHg;			
EXECUTE EXPRESSION as 1.1inHg;			

EXECUTE EXPRESSION as 1.1cal;			
EXECUTE EXPRESSION as 1.1kcal;			
EXECUTE EXPRESSION as 1.1ct;			
EXECUTE EXPRESSION as 1.1dF;			

-- unit conversion
--- relational model temperature unit conversions
INSERT (YEAR_OBSERV, CITY, MAX_TEMP, MIN_TEMP) VALUES (1984, 'Sun City', 110, 44);
INSERT (YEAR_OBSERV, CITY, MAX_TEMP, MIN_TEMP) VALUES (1984, 'Iceburg', 45, -90);
INSERT (YEAR_OBSERV, CITY, MAX_TEMP, MIN_TEMP) VALUES (1984, 'Abeland', 101, 10);
INSERT (YEAR_OBSERV, CITY, MAX_TEMP, MIN_TEMP) VALUES (1985, 'Sun City', 105, 50);
INSERT (YEAR_OBSERV, CITY, MAX_TEMP, MIN_TEMP) VALUES (1985, 'Iceburg', 47, -82);
INSERT (YEAR_OBSERV, CITY, MAX_TEMP, MIN_TEMP) VALUES (1985, 'Abeland', 98, -3);

CREATE CLASS TEMP_OBSERV AS SELECT * WHERE EXISTS(YEAR_OBSERV) AND EXISTS(CITY);

CREATE CLASS CELSIUS_OBSERV AS 
    SELECT CITY, YEAR_OBSERV, (MIN_TEMP - 32) * 5 / 9 AS MIN_C,
                (MAX_TEMP - 32) * 5 / 9 AS MAX_C
    FROM TEMP_OBSERV;

CREATE CLASS MULTI_YEAR_OBSERV AS 
    SELECT CITY, AVG(MAX_TEMP) AS HIGH, AVG(MIN_TEMP) AS LOW
    FROM TEMP_OBSERV
    GROUP BY CITY;

CREATE CLASS EXTREME_TEMPS AS 
    SELECT YEAR_OBSERV, MAX(MAX_TEMP) AS HIGH, MIN(MIN_TEMP) AS LOW
    FROM TEMP_OBSERV
    GROUP BY YEAR_OBSERV;

-- TEST:0391 Correlation names used in self-join of view!
     SELECT X.CITY, X.MAX_C, Y.MAX_C,
           (X.MAX_C + Y.MAX_C) / 2
           FROM CELSIUS_OBSERV X, CELSIUS_OBSERV Y
           WHERE X.YEAR_OBSERV = 1984 AND
                Y.YEAR_OBSERV = 1985 AND
                X.CITY = Y.CITY
                ORDER BY 4 DESC;

-- TEST:0401 VIEW with computed columns!
    SELECT CITY, YEAR_OBSERV, MIN_C, MAX_C
          FROM CELSIUS_OBSERV
          WHERE YEAR_OBSERV = 1984 AND MIN_C > 5;
		  
    SELECT CITY, HIGH, LOW 
          FROM MULTI_YEAR_OBSERV
          ORDER BY CITY ASC;

   SELECT HIGH, YEAR_OBSERV, LOW 
              FROM EXTREME_TEMPS
              ORDER BY YEAR_OBSERV DESC;
		 
--- relational model other unit conversions
INSERT (C_NUM, C_NAME) VALUES (17, 'Wheat');
INSERT (C_NUM, C_NAME) VALUES (14, 'Saffron');
INSERT (C_NUM, C_NAME) VALUES (23, 'Alfalfa');
CREATE CLASS COMMODITY AS SELECT * WHERE EXISTS(C_NUM) AND EXISTS(C_NAME);

INSERT (CURRENCY, DOLLAR_EQUIV) VALUES ('DOLLAR', 1.00);
INSERT (CURRENCY, DOLLAR_EQUIV) VALUES ('POUND', 1.91);
INSERT (CURRENCY, DOLLAR_EQUIV) VALUES ('DM', .45);
CREATE CLASS CURRENCY_TABLE AS SELECT * WHERE EXISTS(CURRENCY) AND EXISTS(DOLLAR_EQUIV);

INSERT (MEASURE, POUND_EQUIV) VALUES ('POUND', 1.00);
INSERT (MEASURE, POUND_EQUIV) VALUES ('OUNCE', .06);
INSERT (MEASURE, POUND_EQUIV) VALUES ('KILO', 2.20);
INSERT (MEASURE, POUND_EQUIV) VALUES ('TON', 2000.00);
CREATE CLASS MEASURE_TABLE AS SELECT * WHERE EXISTS(MEASURE) AND EXISTS(POUND_EQUIV);

INSERT (COMMOD_NO, TOT_PRICE, CURRENCY, UNITS, MEASURE, T_DATE)
       VALUES (17, 1411.5, 'DM', 4000, 'KILO', 871212);
INSERT (COMMOD_NO, TOT_PRICE, CURRENCY, UNITS, MEASURE, T_DATE)
       VALUES (17, 7000.0, 'POUND', 100, 'TON', 871012);
INSERT (COMMOD_NO, TOT_PRICE, CURRENCY, UNITS, MEASURE, T_DATE)
       VALUES (23, 20000.0, 'DOLLAR', 40000, 'POUND', 880707);
INSERT (COMMOD_NO, TOT_PRICE, CURRENCY, UNITS, MEASURE, T_DATE)
       VALUES (14, 10000.0, 'DM', 900, 'OUNCE', 880606);
INSERT (COMMOD_NO, TOT_PRICE, CURRENCY, UNITS, MEASURE, T_DATE)
       VALUES (14, 10000.0, 'DM', 900, 'OUNCE', 880707);
CREATE CLASS C_TRANSACTION AS SELECT * WHERE EXISTS(COMMOD_NO) AND EXISTS(TOT_PRICE) 
	AND EXISTS(CURRENCY) AND EXISTS(UNITS) AND EXISTS(MEASURE) AND EXISTS(T_DATE);
-- TEST:0402 Computed GROUP BY view over referencing tables!
SELECT COUNT(*) FROM C_TRANSACTION WHERE COMMOD_NO = 17;

SELECT UNIT_PRICE, FROM_DATE, TO_DATE, COMMODITY
    FROM DOLLARS_PER_POUND
    ORDER BY COMMODITY DESC;

-- TEST:0403 View on computed GROUP BY view with join!
-- NOTE:  OPTIONAL test
     SELECT COUNT(*) FROM COST_PER_UNIT;

SELECT CURRENCY, MEASURE, UNIT_PRICE, COMMODITY
    FROM COST_PER_UNIT;

-- TEST:0413 Computed SELECT on computed VIEW!
SELECT (100 + 7) * UNIT_PRICE * 700 / 100, COMMODITY
    FROM DOLLARS_PER_POUND
    ORDER BY COMMODITY;

--- report error: can not convert
EXECUTE EXPRESSION as 1.1m = 110kg;  
EXECUTE EXPRESSION as 1.1m - 110kg;   
--- equal: test UnitDscr.shift in mvstore\kernel\src\units.cpp
EXECUTE EXPRESSION as 1.1m = 110cm;  
EXECUTE EXPRESSION as 1.1m - 110cm; 

--- equal: test UnitDscr.shift in mvstore\kernel\src\units.cpp
EXECUTE EXPRESSION as 0dC = 273.15K;
EXECUTE EXPRESSION as 0dC - 273.15K;
EXECUTE EXPRESSION as (0dC - 273.15K)/273.15K;
EXECUTE EXPRESSION as (0dC - 273.15K)/0dC;
EXECUTE EXPRESSION as 0dC / 273.15K;

EXECUTE EXPRESSION as 0dC = 32dF;
EXECUTE EXPRESSION as 0dC - 32dF;

EXECUTE EXPRESSION as 100dC = 212dF;
EXECUTE EXPRESSION as 100dC - 212dF;
EXECUTE EXPRESSION as (100dC - 212dF)/100dC;
EXECUTE EXPRESSION as (100dC - 212dF)/212dF;
EXECUTE EXPRESSION as 100dC / 212dF;

-- specify unit for query select items
 	
-- unit compatiblility testing for a class creation

</pre>
<!-- end highlighted code -->

</div>
