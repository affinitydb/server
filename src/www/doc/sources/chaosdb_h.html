<head>
  <link href='../css/ksdoc.css' rel='stylesheet' type='text/css' />
  <link href='../css/source.css' rel='stylesheet' type='text/css' />
</head>
<div id="chaosdb_h">
<h1>chaosdb.h</h1>

<!-- begin highlighted code -->
<div class="highlight"><pre><span class="cm">/**************************************************************************************</span>

<span class="cm">Copyright Â© 2004-2010 VMware, Inc. All rights reserved.</span>

<span class="cm">Written by Mark Venguerov 2004 - 2010</span>

<span class="cm">**************************************************************************************/</span>

<span class="cp">#ifndef _STORE_H_</span>
<span class="cp">#define _STORE_H_</span>

<span class="cp">#undef MV_EXP</span>
<span class="cp">#ifndef _MSC_VER</span>
<span class="cp">#define MV_EXP</span>
<span class="cp">#else</span>
<span class="cp">#define MV_EXP _declspec(dllexport)</span>
<span class="cp">#endif</span>
<span class="cp">#include &lt;stdint.h&gt;</span>
<span class="cp">#include &lt;stddef.h&gt;</span>
<span class="cp">#include &lt;stdarg.h&gt;</span>
<span class="cp">#include &lt;string.h&gt;</span>

<span class="cp">#include &quot;rc.h&quot;</span>
<span class="cp">#include &quot;units.h&quot;</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">MVStoreRC</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">MVStoreKernel</span> <span class="p">{</span><span class="n">class</span> <span class="n">StoreCtx</span><span class="p">;}</span>

<span class="k">typedef</span> <span class="n">MVStoreKernel</span><span class="o">::</span><span class="n">StoreCtx</span> <span class="o">*</span><span class="n">MVStoreCtx</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Namespace to encapsulate the public interface of mvstore.</span>
<span class="cm"> * Overview:</span>
<span class="cm"> *  ISession represents a client&#39;s connection to the store.</span>
<span class="cm"> *  IPIN represents a PIN, i.e. a node of information.</span>
<span class="cm"> *  Through its ISession, a client can create, query, modify and delete PINs, control transactions, set session parameters, etc.</span>
<span class="cm"> *  Through IPIN, one can create, query, modify and delete properties or clone the PIN optionally overwriting properties.</span>
<span class="cm"> */</span>
<span class="n">namespace</span> <span class="n">MVStore</span> 
<span class="p">{</span>
    <span class="k">typedef</span>  <span class="kt">uint32_t</span>                    <span class="n">IdentityID</span><span class="p">;</span>   <span class="cm">/**&lt; Identity ID - used to represent the identity in this store */</span>
    <span class="k">typedef</span>  <span class="kt">uint32_t</span>                    <span class="n">URIID</span><span class="p">;</span>        <span class="cm">/**&lt; URI ID - used to represent a URI in this store */</span>
    <span class="k">typedef</span>  <span class="n">URIID</span>                        <span class="n">ClassID</span><span class="p">;</span>  <span class="cm">/**&lt; Class ID - used to represent the class URI in this store */</span>
    <span class="k">typedef</span>  <span class="n">URIID</span>                        <span class="n">PropertyID</span><span class="p">;</span>   <span class="cm">/**&lt; Property ID - same as URIID */</span>
    <span class="k">typedef</span>  <span class="kt">uint32_t</span>                    <span class="n">ElementID</span><span class="p">;</span>    <span class="cm">/**&lt; Immutable collection element ID */</span>
    <span class="k">typedef</span>  <span class="kt">uint32_t</span>                    <span class="n">VersionID</span><span class="p">;</span>    <span class="cm">/**&lt; Version number */</span>

<span class="cp">   #define STORE_INVALID_PID           0ULL</span>
<span class="cp">   #define STORE_INVALID_PROPID        (~MVStore::PropertyID(0))   </span>
<span class="cp">   #define STORE_INVALID_IDENTITY      (~MVStore::IdentityID(0))   </span>
<span class="cp">   #define STORE_INVALID_CLASSID       (~MVStore::ClassID(0))  </span>
<span class="cp">   #define STORE_CURRENT_VERSION       (~MVStore::VersionID(0))    </span>
<span class="cp">   #define STORE_MAX_URIID             MVStore::URIID(0x1FFFFFFF)      </span><span class="cm">/**&lt; Maximum value for URIID */</span><span class="cp"></span>

    <span class="cm">/**</span>
<span class="cm">    * special identity ID</span>
<span class="cm">    */</span>
<span class="cp">   #define STORE_OWNER                 MVStore::IdentityID(0)          </span><span class="cm">/**&lt; The owner of the store always has IdentityID equals to 0 */</span><span class="cp"></span>


    <span class="cm">/**</span>
<span class="cm">    * special property and class IDs</span>
<span class="cm">    */</span>
<span class="cp">   #define STORE_CLASS_OF_CLASSES      MVStore::ClassID(0)             </span><span class="cm">/**&lt; Fixed ID of the class of all classes in the store */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_PINID             MVStore::PropertyID(1)          </span><span class="cm">/**&lt; PIN id as PIN&#39;s property, immutable */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_DOCUMENT          MVStore::PropertyID(2)          </span><span class="cm">/**&lt; document PIN this PIN is a part of */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_PARENT            MVStore::PropertyID(3)          </span><span class="cm">/**&lt; parent (whole) PIN */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_VALUE             MVStore::PropertyID(4)          </span><span class="cm">/**&lt; value of the PIN (can be an expression using other properties */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_CREATED           MVStore::PropertyID(5)          </span><span class="cm">/**&lt; PIN creation timestamp, immutable */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_CREATEDBY         MVStore::PropertyID(6)          </span><span class="cm">/**&lt; identity created the PIN, immutable */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_UPDATED           MVStore::PropertyID(7)          </span><span class="cm">/**&lt; timestamp of the latest PIN modification, updated automatically */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_UPDATEDBY         MVStore::PropertyID(8)          </span><span class="cm">/**&lt; identity of the latest PIN modification, updated automatically */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_ACL               MVStore::PropertyID(9)          </span><span class="cm">/**&lt; ACL - can be a collection and contain references to other PINs */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_URI               MVStore::PropertyID(10)         </span><span class="cm">/**&lt; External (RDF) URI of a pin, class or relation */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_STAMP             MVStore::PropertyID(11)         </span><span class="cm">/**&lt; stamp (unsigned integer) of the latest modification, updated automatically */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_CLASSID           MVStore::PropertyID(12)         </span><span class="cm">/**&lt; classID of the class represented by this pin (VT_CLASSID) */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_PREDICATE         MVStore::PropertyID(13)         </span><span class="cm">/**&lt; predicate of a class or relations (VT_STMT) */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_NINSTANCES        MVStore::PropertyID(14)         </span><span class="cm">/**&lt; number of instances of a given class currently in the store */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_NDINSTANCES       MVStore::PropertyID(15)         </span><span class="cm">/**&lt; number of soft-deleted instances of a given class currently in the store */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_SUBCLASSES        MVStore::PropertyID(16)         </span><span class="cm">/**&lt; collection of classes which are specializations of this class */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_SUPERCLASSES      MVStore::PropertyID(17)         </span><span class="cm">/**&lt; collection of classes which are abstractions of this class */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_CLASS_INFO        MVStore::PropertyID(18)         </span><span class="cm">/**&lt; bit flags describing the class (VT_UINT) */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_INDEX_INFO        MVStore::PropertyID(19)         </span><span class="cm">/**&lt; Family index information */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_PROPERTIES        MVStore::PropertyID(20)         </span><span class="cm">/**&lt; Properties refered by the class */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_JOIN_TRIGGER      MVStore::PropertyID(21)         </span><span class="cm">/**&lt; Triggers associated with class events */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_UPDATE_TRIGGER    MVStore::PropertyID(22)         </span><span class="cm">/**&lt; Triggers associated with class events */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_LEAVE_TRIGGER     MVStore::PropertyID(23)         </span><span class="cm">/**&lt; Triggers associated with class events */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_REFID             MVStore::PropertyID(24)         </span><span class="cm">/**&lt; Future implementation */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_KEY               MVStore::PropertyID(25)         </span><span class="cm">/**&lt; Future implementation */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_VERSION           MVStore::PropertyID(26)         </span><span class="cm">/**&lt; Chain of versions */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_WEIGHT            MVStore::PropertyID(27)         </span><span class="cm">/**&lt; Future implementation */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_PROTOTYPE         MVStore::PropertyID(28)         </span><span class="cm">/**&lt; JavaScript-like inheritance */</span><span class="cp"></span>
<span class="cp">   #define PROP_SPEC_WINDOW            MVStore::PropertyID(29)         </span><span class="cm">/**&lt; Stream windowing control (size of class-related window) */</span><span class="cp"></span>

<span class="cp">   #define PROP_SPEC_MAX               PROP_SPEC_WINDOW</span>
<span class="cp">   </span>
<span class="cp">   #define PROP_SPEC_ANY               (~MVStore::PropertyID(0))       </span><span class="cm">/**&lt; used in queries, matches any property */</span><span class="cp"></span>

    <span class="cm">/**</span>
<span class="cm">    * special collection element IDs</span>
<span class="cm">    */</span>
<span class="cp">   #define STORE_COLLECTION_ID         (~MVStore::ElementID(0))        </span><span class="cm">/**&lt; Singleton value or operation applied to the whole collection */</span><span class="cp"></span>
<span class="cp">   #define STORE_LAST_ELEMENT          (~MVStore::ElementID(1))        </span><span class="cm">/**&lt; Last element of a collection */</span><span class="cp"></span>
<span class="cp">   #define STORE_FIRST_ELEMENT         (~MVStore::ElementID(2))        </span><span class="cm">/**&lt; First element of a collection */</span><span class="cp"></span>
<span class="cp">   #define STORE_SUM_COLLECTION        (~MVStore::ElementID(3))        </span><span class="cm">/**&lt; IStmt: replace collection with the sum of its elements */</span><span class="cp"></span>
<span class="cp">   #define STORE_AVG_COLLECTION        (~MVStore::ElementID(4))        </span><span class="cm">/**&lt; IStmt: replace collection with the average of its elements */</span><span class="cp"></span>
<span class="cp">   #define STORE_CONCAT_COLLECTION     (~MVStore::ElementID(5))        </span><span class="cm">/**&lt; IStmt: replace collection with the concatenation of its elements */</span><span class="cp"></span>
<span class="cp">   #define STORE_MIN_ELEMENT           (~MVStore::ElementID(6))        </span><span class="cm">/**&lt; IStmt: replace collection with the minimum of its elements */</span><span class="cp"></span>
<span class="cp">   #define STORE_MAX_ELEMENT           (~MVStore::ElementID(7))        </span><span class="cm">/**&lt; IStmt: replace collection with the maximum of its elements */</span><span class="cp"></span>
<span class="cp">   #define STORE_SOME_ELEMENT          (~MVStore::ElementID(8))        </span><span class="cm">/**&lt; IStmt: existential quantifier for the collection */</span><span class="cp"></span>
<span class="cp">   #define STORE_ALL_ELEMENTS          (~MVStore::ElementID(9))        </span><span class="cm">/**&lt; IStmt: &#39;for all&#39; quantifier */</span><span class="cp"></span>

    <span class="cm">/**</span>
<span class="cm">    * PIN create/commit/modify/delete, IStmt execute mode flags</span>
<span class="cm">    */</span>
<span class="cp">   #define MODE_NO_EID                 0x00010000  </span><span class="cm">/**&lt; in modify() - don&#39;t update &quot;eid&quot; field of Value structure */</span><span class="cp"></span>
<span class="cp">   #define MODE_FOR_UPDATE             0x00020000  </span><span class="cm">/**&lt; in IStmt::execute(): lock pins for update while reading them */</span><span class="cp"></span>
<span class="cp">   #define MODE_NEW_COMMIT             0x00040000  </span><span class="cm">/**&lt; used in PIN::clone() to immediately commit a cloned pin */</span><span class="cp"></span>
<span class="cp">   #define MODE_PURGE                  0x00040000  </span><span class="cm">/**&lt; in deletePINs(): purge pins rather than just delete */</span><span class="cp"></span>
<span class="cp">   #define MODE_PRESERVE_INSERT_ORDER  0x00040000  </span><span class="cm">/**&lt; in commitPINs() - preserve insert order when allocating pins on pages */</span><span class="cp"></span>
<span class="cp">   #define MODE_ALL                    0x00040000  </span><span class="cm">/**&lt; for STMT_COMMIT, STMT_ROLLBACK - commit/rollback all nested transactions */</span><span class="cp"></span>
<span class="cp">   #define MODE_READONLY               0x00040000  </span><span class="cm">/**&lt; for STMT_START_TX - start r/o transaction */</span><span class="cp"></span>
<span class="cp">   #define MODE_COPY_VALUES            0x00080000  </span><span class="cm">/**&lt; used in createUncommittedPIN() and IStmt::execute() to copy Values (parameters, query expressions, etc.) passed rather than assume ownership */</span><span class="cp"></span>
<span class="cp">   #define MODE_FORCE_EIDS             0x00100000  </span><span class="cm">/**&lt; used only in replication */</span><span class="cp"></span>
<span class="cp">   #define MODE_PURGE_IDS              0x00100000  </span><span class="cm">/**&lt; in deletePINs(): purge pins and reuse their slots on pages (so their IDs are not unique) */</span><span class="cp"></span>
<span class="cp">   #define MODE_PART                   0x00100000  </span><span class="cm">/**&lt; in nested insert: create a part */</span><span class="cp"></span>
<span class="cp">   #define MODE_CHECK_STAMP            0x00200000  </span><span class="cm">/**&lt; forces stamp check before modification; if stamp changed the op is aborted and RC_REPEAT is returned */</span><span class="cp"></span>
<span class="cp">   #define MODE_HOLD_RESULT            0x00200000  </span><span class="cm">/**&lt; for IStmt::execute(): don&#39;t close result set on transaction commit/rollback */</span><span class="cp"></span>
<span class="cp">   #define MODE_ALL_WORDS              0x00400000  </span><span class="cm">/**&lt; all words must be present in FT condition */</span><span class="cp"></span>
<span class="cp">   #define MODE_DELETED                0x00800000  </span><span class="cm">/**&lt; for query: return only (soft)deleted pins */</span><span class="cp"></span>
<span class="cp">   #define MODE_SSV_AS_STREAM          0x01000000  </span><span class="cm">/**&lt; for getPIN(), IStmt::execute() - return SSVs as streams instead of strings */</span><span class="cp"></span>
<span class="cp">   #define MODE_FORCED_SSV_AS_STREAM   0x02000000  </span><span class="cm">/**&lt; for getPIN(), IStmt::execute(): return only META_PROP_SSTORAGE SSVs as streams instead of strings */</span><span class="cp"></span>
<span class="cp">   #define MODE_VERBOSE                0x04000000  </span><span class="cm">/**&lt; in IStmt::execute(): print evaluation plan */</span><span class="cp"></span>

    <span class="cm">/**</span>
<span class="cm">    * PIN creation flags</span>
<span class="cm">    */</span>
<span class="cp">   #define PIN_NO_REPLICATION          0x40000000  </span><span class="cm">/**&lt; marks a pin as one which shouldn&#39;t be replicated (only when the pin is committed) */</span><span class="cp"></span>
<span class="cp">   #define PIN_NO_INDEX                0x20000000  </span><span class="cm">/**&lt; special pin - no indexing */</span><span class="cp"></span>
<span class="cp">   #define PIN_NOTIFY                  0x10000000  </span><span class="cm">/**&lt; pin generates notifications */</span><span class="cp"></span>
<span class="cp">   #define PIN_REPLICATED              0x08000000  </span><span class="cm">/**&lt; pin is replicated to another store or is a replica */</span><span class="cp"></span>
<span class="cp">   #define PIN_HIDDEN                  0x04000000  </span><span class="cm">/**&lt; special pin - totally hidden from search/replication - accessible only through its PID */</span><span class="cp"></span>

    <span class="cm">/**</span>
<span class="cm">    * meta-properties</span>
<span class="cm">    */</span>
<span class="cp">   #define META_PROP_PART              0x80        </span><span class="cm">/**&lt; property is a reference to a PIN which is a part of this one */</span><span class="cp"></span>
<span class="cp">   #define META_PROP_NOFTINDEX         0x80        </span><span class="cm">/**&lt; this property is not to be FT indexed/searched */</span><span class="cp"></span>
<span class="cp">   #define META_PROP_EVAL              0x80        </span><span class="cm">/**&lt; eval IExpr/IStmt in commitPINs/modifyPIN */</span><span class="cp"></span>
<span class="cp">   #define META_PROP_SSTORAGE          0x40        </span><span class="cm">/**&lt; store this property separately from the pin body (for string, stream and collection property types) */</span><span class="cp"></span>
<span class="cp">   #define META_PROP_RACCESS           0x40        </span><span class="cm">/**&lt; a stream should be optimized for random access */</span><span class="cp"></span>
<span class="cp">   #define META_PROP_NONOTIFICATION    0x20        </span><span class="cm">/**&lt; this property doesn&#39;t generate notifications when modified */</span><span class="cp"></span>
<span class="cp">   #define META_PROP_INHERIT           0x10        </span><span class="cm">/**&lt; inherited property of a class (equiv. to a method if VT_EXPR or to a static member) */</span><span class="cp"></span>
<span class="cp">   #define META_PROP_IFEXIST           0x08        </span><span class="cm">/**&lt; in modify/transform - apply modification if property exists, otherwise - ignore */</span><span class="cp"></span>
<span class="cp">   #define META_PROP_IFNOTEXIST        0x04        </span><span class="cm">/**&lt; in modify/transform - apply modification (OP_SET or OP_ADD) if property doesn&#39;t exist, otherwise - ignore */</span><span class="cp"></span>
<span class="cp">   #define META_PROP_DERIVED           0x04        </span><span class="cm">/**&lt; this property was calculated from other properties in Transform rather than stored with the pin */</span><span class="cp"></span>
<span class="cp">   #define META_PROP_STOPWORDS         0x02        </span><span class="cm">/**&lt; filter stop words in ft indexing */</span><span class="cp"></span>

    <span class="cm">/**</span>
<span class="cm">    * ACL permissions</span>
<span class="cm">    */</span>
<span class="cp">   #define ACL_READ                    0x0001</span>
<span class="cp">   #define ACL_WRITE                   0x0002</span>

    <span class="cm">/**</span>
<span class="cm">    * Class flags</span>
<span class="cm">    * @returned in PROP_SPEC_CLASS_INFO property of a class pin</span>
<span class="cm">    */</span>

<span class="cp">   #define CLASS_SDELETE               0x0001      </span><span class="cm">/**&lt; Class supports soft-delete optimization */</span><span class="cp"></span>
<span class="cp">   #define CLASS_VIEW                  0x0002      </span><span class="cm">/**&lt; Class membership is not to be indexed */</span><span class="cp"></span>
<span class="cp">   #define CLASS_CLUSTERED             0x0004      </span><span class="cm">/**&lt; PINs belonging to class are clustered for more efficient sequential scan */</span><span class="cp"></span>
<span class="cp">   #define CLASS_INDEXED               0x0008      </span><span class="cm">/**&lt; Class membership is indexed (set by the kernel) */</span><span class="cp"></span>
<span class="cp">   #define CLASS_UNIQUE                0x0010      </span><span class="cm">/**&lt; Unique family */</span><span class="cp"></span>

    <span class="cm">/**</span>
<span class="cm">    * class-related notification flags</span>
<span class="cm">    * @see ISession::setNotification()</span>
<span class="cm">    */</span>
<span class="cp">   #define CLASS_NOTIFY_JOIN           0x0001      </span><span class="cm">/**&lt; a pin becomes a member of the class */</span><span class="cp"></span>
<span class="cp">   #define CLASS_NOTIFY_LEAVE          0x0002      </span><span class="cm">/**&lt; a pin stops to be a member of the class */</span><span class="cp"></span>
<span class="cp">   #define CLASS_NOTIFY_CHANGE         0x0004      </span><span class="cm">/**&lt; a member of the class was changed */</span><span class="cp"></span>
<span class="cp">   #define CLASS_NOTIFY_DELETE         0x0008      </span><span class="cm">/**&lt; a pin - a member of the class - was deleted */</span><span class="cp"></span>
<span class="cp">   #define CLASS_NOTIFY_NEW            0x0010      </span><span class="cm">/**&lt; a new pin was created as a member of the class */</span><span class="cp"></span>

    <span class="cm">/**</span>
<span class="cm">    * types of transactions</span>
<span class="cm">    */</span>
    <span class="k">enum</span> <span class="n">TX_TYPE</span>
    <span class="p">{</span>
        <span class="n">TXT_READONLY</span><span class="p">,</span> <span class="n">TXT_READWRITE</span><span class="p">,</span> <span class="n">TXT_MODIFYCLASS</span>
    <span class="p">};</span>

    <span class="cm">/**</span>
<span class="cm">    * transaction isolation levels</span>
<span class="cm">    */</span>
    <span class="k">enum</span> <span class="n">TXI_LEVEL</span>
    <span class="p">{</span>
        <span class="n">TXI_DEFAULT</span><span class="p">,</span>
        <span class="n">TXI_READ_UNCOMMITTED</span><span class="p">,</span>
        <span class="n">TXI_READ_COMMITTED</span><span class="p">,</span>
        <span class="n">TXI_REPEATABLE_READ</span><span class="p">,</span>
        <span class="n">TXI_SERIALIZABLE</span>
    <span class="p">};</span>

    <span class="cm">/**</span>
<span class="cm">    * toString() functions control flags</span>
<span class="cm">    * @see IStmt::toString(), IExpr::toString(), IExprTree::toString()</span>
<span class="cm">    */</span>
<span class="cp">   #define TOS_PROLOGUE                0x40000000</span>
<span class="cp">   #define TOS_NO_QNAMES               0x80000000</span>

    <span class="cm">/**</span>
<span class="cm">    * interface control flags</span>
<span class="cm">    * @see ISession::setInterfaceMode()</span>
<span class="cm">    */</span>
<span class="cp">   #define ITF_DEFAULT_REPLICATION     0x0001      </span><span class="cm">/**&lt; by default all new pins marked as replicated */</span><span class="cp"></span>
<span class="cp">   #define ITF_REPLICATION             0x0002      </span><span class="cm">/**&lt; replication session */</span><span class="cp"></span>
<span class="cp">   #define ITF_CATCHUP                 0x0004      </span><span class="cm">/**&lt; catchup session */</span><span class="cp"></span>
<span class="cp">   #define ITF_SPARQL                  0x0008      </span><span class="cm">/**&lt; default style for text statement representation (if the flag is not set - SQL) */</span><span class="cp"></span>

    <span class="cm">/**</span>
<span class="cm">    * Trace control flags</span>
<span class="cm">    */</span>

<span class="cp">   #define TRACE_SESSION_QUERIES       0x0001      </span><span class="cm">/**&lt; trace all queries executed within this session */</span><span class="cp"></span>
<span class="cp">   #define TRACE_STORE_BUFFERS         0x0002      </span><span class="cm">/**&lt; not implemented yet */</span><span class="cp"></span>
<span class="cp">   #define TRACE_STORE_IO              0x0004      </span><span class="cm">/**&lt; not implemented yet */</span><span class="cp"></span>
<span class="cp">   #define TRACE_EXEC_PLAN             0x0008      </span><span class="cm">/**&lt; output execution plan for all queries in this session */</span><span class="cp"></span>

    <span class="cm">/**</span>
<span class="cm">    * External timestamp (VT_DATETIME) representation</span>
<span class="cm">    * @see ISession::convDateTime()</span>
<span class="cm">    */</span>
    <span class="k">struct</span> <span class="n">DateTime</span>
    <span class="p">{</span>
        <span class="kt">uint16_t</span>    <span class="n">year</span><span class="p">;</span>
        <span class="kt">uint16_t</span>    <span class="n">month</span><span class="p">;</span>
        <span class="kt">uint16_t</span>    <span class="n">dayOfWeek</span><span class="p">;</span>
        <span class="kt">uint16_t</span>    <span class="n">day</span><span class="p">;</span>
        <span class="kt">uint16_t</span>    <span class="n">hour</span><span class="p">;</span>
        <span class="kt">uint16_t</span>    <span class="n">minute</span><span class="p">;</span>
        <span class="kt">uint16_t</span>    <span class="n">second</span><span class="p">;</span>
        <span class="kt">uint32_t</span>    <span class="n">microseconds</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="cm">/**</span>
<span class="cm">    * Enumeration of subtypes for VT_CURRENT</span>
<span class="cm">    * @see Value</span>
<span class="cm">    */</span>
    <span class="k">enum</span> <span class="n">CurrentValue</span>
    <span class="p">{</span>
        <span class="n">CVT_TIMESTAMP</span><span class="p">,</span> <span class="n">CVT_USER</span><span class="p">,</span> <span class="n">CVT_STORE</span>
    <span class="p">};</span>
    <span class="k">enum</span> <span class="n">ExtractType</span>
    <span class="p">{</span>
        <span class="n">EY_FRACTIONAL</span><span class="p">,</span> <span class="n">EY_SECOND</span><span class="p">,</span> <span class="n">EY_MINUTE</span><span class="p">,</span> <span class="n">EY_HOUR</span><span class="p">,</span> <span class="n">EY_DAY</span><span class="p">,</span> <span class="n">EY_WDAY</span><span class="p">,</span> <span class="n">EY_MONTH</span><span class="p">,</span> <span class="n">EY_YEAR</span><span class="p">,</span>
        <span class="n">EY_IDENTITY</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="cm">/**</span>
<span class="cm">    * Supported value types</span>
<span class="cm">    * @see Value</span>
<span class="cm">    */</span>
    <span class="k">enum</span> <span class="n">ValueType</span> 
    <span class="p">{</span>
        <span class="n">VT_ERROR</span><span class="p">,</span><span class="n">VT_ANY</span><span class="o">=</span><span class="n">VT_ERROR</span><span class="p">,</span>     <span class="cm">/**&lt; used to report errors, non-existant properties; VT_ANY designates no conversion in transforms */</span>

        <span class="n">VT_INT</span><span class="p">,</span>                           <span class="cm">/**&lt; 32-bit signed integer */</span>
        <span class="n">VT_UINT</span><span class="p">,</span>                      <span class="cm">/**&lt; 32-bit unsigned integer */</span>
        <span class="n">VT_INT64</span><span class="p">,</span>                     <span class="cm">/**&lt; 64-bit signed integer */</span>
        <span class="n">VT_UINT64</span><span class="p">,</span>                        <span class="cm">/**&lt; 64-bit unsigned integer */</span>
        <span class="n">VT_DECIMAL</span><span class="p">,</span>                       <span class="cm">/**&lt; decimal number (for some SQL databases compatibility) */</span>
        <span class="n">VT_FLOAT</span><span class="p">,</span>                     <span class="cm">/**&lt; 32-bit floating number */</span>
        <span class="n">VT_DOUBLE</span><span class="p">,</span>                        <span class="cm">/**&lt; 64-bit floating number */</span>

        <span class="n">VT_BOOL</span><span class="p">,</span>                      <span class="cm">/**&lt; boolean value (true, false) */</span>

        <span class="n">VT_DATETIME</span><span class="p">,</span>                  <span class="cm">/**&lt; timestamp stored as a 64-bit number of microseconds since fixed date */</span>
        <span class="n">VT_INTERVAL</span><span class="p">,</span>                  <span class="cm">/**&lt; time interval stored as a 64-bit signed number of microseconds */</span>

        <span class="n">VT_URIID</span><span class="p">,</span>                     <span class="cm">/**&lt; URIID */</span>
        <span class="n">VT_IDENTITY</span><span class="p">,</span>                  <span class="cm">/**&lt; IdentityID */</span>

        <span class="n">VT_STRING</span><span class="p">,</span>                        <span class="cm">/**&lt; zero-ended string UTF-8*/</span>
        <span class="n">VT_BSTR</span><span class="p">,</span>                      <span class="cm">/**&lt; binary string */</span>
        <span class="n">VT_URL</span><span class="p">,</span>                           <span class="cm">/**&lt; URL string with special interpretation, UTF-8 */</span>
        <span class="n">VT_ENUM</span><span class="p">,</span>                      <span class="cm">/**&lt; an enumeration value &#39;by value&#39; i.e. 32-bit unsigned integer */</span>

        <span class="n">VT_REF</span><span class="p">,</span>                           <span class="cm">/**&lt; a reference to another IPIN */</span>
        <span class="n">VT_REFID</span><span class="p">,</span>                     <span class="cm">/**&lt; a reference to another PIN by its PID */</span>
        <span class="n">VT_REFPROP</span><span class="p">,</span>                       <span class="cm">/**&lt; a reference to a value (property of this or another PIN) by IPIN &amp; PropertyID */</span>
        <span class="n">VT_REFIDPROP</span><span class="p">,</span>                 <span class="cm">/**&lt; a reference to a value (property of this or another PIN) by its PID/PropertyID */</span>
        <span class="n">VT_REFELT</span><span class="p">,</span>                        <span class="cm">/**&lt; a reference to a collection element by its IPIN/PropertyID/ElementID */</span>
        <span class="n">VT_REFIDELT</span><span class="p">,</span>                  <span class="cm">/**&lt; a reference to a collection element by its PID/PropertyID/ElementID */</span>

        <span class="n">VT_EXPR</span><span class="p">,</span>                      <span class="cm">/**&lt; stored expression */</span>
        <span class="n">VT_STMT</span><span class="p">,</span>                      <span class="cm">/**&lt; IStmt object */</span>

        <span class="n">VT_ARRAY</span><span class="p">,</span>                     <span class="cm">/**&lt; a collection property, i.e. a property composed of sub-properties */</span>
        <span class="n">VT_COLLECTION</span><span class="p">,</span>                    <span class="cm">/**&lt; collection iterator interface for big collections */</span>
        <span class="n">VT_STRUCT</span><span class="p">,</span>                        <span class="cm">/**&lt; composite value */</span>
        <span class="n">VT_RANGE</span><span class="p">,</span>                     <span class="cm">/**&lt; range of values for OP_IN, equivalent to VT_ARRAY with length = 2 */</span>
        <span class="n">VT_STREAM</span><span class="p">,</span>                        <span class="cm">/**&lt; IStream interface */</span>
        <span class="n">VT_CURRENT</span><span class="p">,</span>                       <span class="cm">/**&lt; current moment in time, current user, etc. */</span>

        <span class="n">VT_VARREF</span><span class="p">,</span>                        <span class="cm">/**&lt; statement: var ref  (cannot be persisted as a property value) */</span>
        <span class="n">VT_EXPRTREE</span><span class="p">,</span>                  <span class="cm">/**&lt; sub-expression reference for statement conditions (cannot be persisted as a property value) */</span>

        <span class="n">VT_ALL</span>
    <span class="p">};</span>

    <span class="kr">inline</span>  <span class="n">bool</span> <span class="nf">isRef</span><span class="p">(</span><span class="n">ValueType</span> <span class="n">vt</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="kt">uint8_t</span><span class="p">(</span><span class="n">vt</span><span class="o">-</span><span class="n">VT_REF</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">uint8_t</span><span class="p">(</span><span class="n">VT_REFIDELT</span><span class="o">-</span><span class="n">VT_REF</span><span class="p">);}</span>
    <span class="kr">inline</span>  <span class="n">bool</span> <span class="nf">isInteger</span><span class="p">(</span><span class="n">ValueType</span> <span class="n">vt</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="kt">uint8_t</span><span class="p">(</span><span class="n">vt</span><span class="o">-</span><span class="n">VT_INT</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">uint8_t</span><span class="p">(</span><span class="n">VT_UINT64</span><span class="o">-</span><span class="n">VT_INT</span><span class="p">);}</span>
    <span class="kr">inline</span>  <span class="n">bool</span> <span class="nf">isNumeric</span><span class="p">(</span><span class="n">ValueType</span> <span class="n">vt</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="kt">uint8_t</span><span class="p">(</span><span class="n">vt</span><span class="o">-</span><span class="n">VT_INT</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">uint8_t</span><span class="p">(</span><span class="n">VT_DOUBLE</span><span class="o">-</span><span class="n">VT_INT</span><span class="p">);}</span>
    <span class="kr">inline</span>  <span class="n">bool</span> <span class="nf">isString</span><span class="p">(</span><span class="n">ValueType</span> <span class="n">vt</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="kt">uint8_t</span><span class="p">(</span><span class="n">vt</span><span class="o">-</span><span class="n">VT_STRING</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">uint8_t</span><span class="p">(</span><span class="n">VT_URL</span><span class="o">-</span><span class="n">VT_STRING</span><span class="p">);}</span>
    <span class="kr">inline</span>  <span class="n">bool</span> <span class="nf">isCollection</span><span class="p">(</span><span class="n">ValueType</span> <span class="n">vt</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="kt">uint8_t</span><span class="p">(</span><span class="n">vt</span><span class="o">-</span><span class="n">VT_ARRAY</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">uint8_t</span><span class="p">(</span><span class="n">VT_COLLECTION</span><span class="o">-</span><span class="n">VT_ARRAY</span><span class="p">);}</span>
    <span class="kr">inline</span>  <span class="n">bool</span> <span class="nf">isComposite</span><span class="p">(</span><span class="n">ValueType</span> <span class="n">vt</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="kt">uint8_t</span><span class="p">(</span><span class="n">vt</span><span class="o">-</span><span class="n">VT_ARRAY</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">uint8_t</span><span class="p">(</span><span class="n">VT_STRUCT</span><span class="o">-</span><span class="n">VT_ARRAY</span><span class="p">);}</span>

    <span class="cm">/**</span>
<span class="cm">    * Supported operations for expressions and property modifications</span>
<span class="cm">    */</span>
    <span class="k">enum</span> <span class="n">ExprOp</span>
    <span class="p">{</span>
        <span class="n">OP_SET</span><span class="p">,</span>                       <span class="cm">/**&lt; used to add a new property or to set a new value for old property */</span>
        <span class="n">OP_ADD</span><span class="p">,</span>                       <span class="cm">/**&lt; adds a new collection element for existing property (doesn&#39;t have to be a collection) */</span>
        <span class="n">OP_ADD_BEFORE</span><span class="p">,</span>                <span class="cm">/**&lt; add a new collection element before existing element (OP_ADD inserts after) */</span>
        <span class="n">OP_MOVE</span><span class="p">,</span>                  <span class="cm">/**&lt; move a collection element to new position */</span>
        <span class="n">OP_MOVE_BEFORE</span><span class="p">,</span>               <span class="cm">/**&lt; move a collection element to new position (before specific element) */</span>          
        <span class="n">OP_DELETE</span><span class="p">,</span>                    <span class="cm">/**&lt; deletes the whole property (non-collection), the whole collection (type==VT_ARRAY), or a collection element (type==VT_UINT, Value::ui==element index) */</span>
        <span class="n">OP_EDIT</span><span class="p">,</span>                  <span class="cm">/**&lt; string editing operation; requires VT_STRING/VT_BSTR/VT_URL property */</span>
        <span class="n">OP_RENAME</span><span class="p">,</span>                    <span class="cm">/**&lt; rename a property, i.e. replace one PropertyID with another one */</span>
        <span class="n">OP_FIRST_EXPR</span><span class="p">,</span>                <span class="cm">/**&lt; start of op codes which can be used in expressions */</span>
        <span class="n">OP_PLUS</span><span class="o">=</span><span class="n">OP_FIRST_EXPR</span><span class="p">,</span>
        <span class="n">OP_MINUS</span><span class="p">,</span>
        <span class="n">OP_MUL</span><span class="p">,</span>
        <span class="n">OP_DIV</span><span class="p">,</span>
        <span class="n">OP_MOD</span><span class="p">,</span>
        <span class="n">OP_NEG</span><span class="p">,</span>
        <span class="n">OP_NOT</span><span class="p">,</span>
        <span class="n">OP_AND</span><span class="p">,</span>
        <span class="n">OP_OR</span><span class="p">,</span>
        <span class="n">OP_XOR</span><span class="p">,</span>
        <span class="n">OP_LSHIFT</span><span class="p">,</span>
        <span class="n">OP_RSHIFT</span><span class="p">,</span>
        <span class="n">OP_MIN</span><span class="p">,</span>
        <span class="n">OP_MAX</span><span class="p">,</span>
        <span class="n">OP_ABS</span><span class="p">,</span>
        <span class="n">OP_LN</span><span class="p">,</span>
        <span class="n">OP_EXP</span><span class="p">,</span>
        <span class="n">OP_POW</span><span class="p">,</span>
        <span class="n">OP_SQRT</span><span class="p">,</span>
        <span class="n">OP_FLOOR</span><span class="p">,</span>
        <span class="n">OP_CEIL</span><span class="p">,</span>
        <span class="n">OP_CONCAT</span><span class="p">,</span>
        <span class="n">OP_LOWER</span><span class="p">,</span>
        <span class="n">OP_UPPER</span><span class="p">,</span>
        <span class="n">OP_TONUM</span><span class="p">,</span>
        <span class="n">OP_TOINUM</span><span class="p">,</span>
        <span class="n">OP_CAST</span><span class="p">,</span>
        <span class="n">OP_LAST_MODOP</span><span class="o">=</span><span class="n">OP_CAST</span><span class="p">,</span>
        <span class="n">OP_RANGE</span><span class="p">,</span>
        <span class="n">OP_ARRAY</span><span class="p">,</span>
        <span class="n">OP_COUNT</span><span class="p">,</span>
        <span class="n">OP_LENGTH</span><span class="p">,</span>
        <span class="n">OP_POSITION</span><span class="p">,</span>
        <span class="n">OP_SUBSTR</span><span class="p">,</span>
        <span class="n">OP_REPLACE</span><span class="p">,</span>
        <span class="n">OP_PAD</span><span class="p">,</span>
        <span class="n">OP_TRIM</span><span class="p">,</span>
        <span class="n">OP_SUM</span><span class="p">,</span>
        <span class="n">OP_AVG</span><span class="p">,</span>
        <span class="n">OP_VAR_POP</span><span class="p">,</span>
        <span class="n">OP_VAR_SAMP</span><span class="p">,</span>
        <span class="n">OP_STDDEV_POP</span><span class="p">,</span>
        <span class="n">OP_STDDEV_SAMP</span><span class="p">,</span>
        <span class="n">OP_HISTOGRAM</span><span class="p">,</span>
        <span class="n">OP_COALESCE</span><span class="p">,</span>
        <span class="n">OP_PATH</span><span class="p">,</span>
        <span class="n">OP_FIRST_BOOLEAN</span><span class="p">,</span>
        <span class="n">OP_EQ</span><span class="o">=</span><span class="n">OP_FIRST_BOOLEAN</span><span class="p">,</span>
        <span class="n">OP_NE</span><span class="p">,</span>
        <span class="n">OP_LT</span><span class="p">,</span>
        <span class="n">OP_LE</span><span class="p">,</span>
        <span class="n">OP_GT</span><span class="p">,</span>
        <span class="n">OP_GE</span><span class="p">,</span>
        <span class="n">OP_IN</span><span class="p">,</span>
        <span class="n">OP_BEGINS</span><span class="p">,</span>
        <span class="n">OP_CONTAINS</span><span class="p">,</span>
        <span class="n">OP_ENDS</span><span class="p">,</span>
        <span class="n">OP_REGEX</span><span class="p">,</span>
        <span class="n">OP_EXISTS</span><span class="p">,</span>
        <span class="n">OP_ISLOCAL</span><span class="p">,</span>
        <span class="n">OP_IS_A</span><span class="p">,</span>
        <span class="n">OP_LAND</span><span class="p">,</span>
        <span class="n">OP_LOR</span><span class="p">,</span>
        <span class="n">OP_LNOT</span><span class="p">,</span>
        <span class="n">OP_LAST_BOOLEAN</span><span class="o">=</span><span class="n">OP_LNOT</span><span class="p">,</span>

        <span class="n">OP_EXTRACT</span><span class="p">,</span>
        <span class="n">OP_DEREF</span><span class="p">,</span>
        <span class="n">OP_REF</span><span class="p">,</span>
        <span class="n">OP_CALL</span><span class="p">,</span>

        <span class="n">OP_ALL</span>
    <span class="p">};</span>

    <span class="kr">inline</span>  <span class="n">bool</span> <span class="nf">isBool</span><span class="p">(</span><span class="n">ExprOp</span> <span class="n">op</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="kt">unsigned</span><span class="p">(</span><span class="n">op</span><span class="o">-</span><span class="n">OP_FIRST_BOOLEAN</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">unsigned</span><span class="p">(</span><span class="n">OP_LAST_BOOLEAN</span><span class="o">-</span><span class="n">OP_FIRST_BOOLEAN</span><span class="p">);}</span>

    <span class="cm">/**</span>
<span class="cm">    * operation modifiers (bit flags) passed to IExprTree::expr(...)</span>
<span class="cm">    */</span>
<span class="cp">   #define UNSIGNED_OP             0x0001  </span><span class="c1">// unsigned op (for right shift)</span>
<span class="cp">   #define CASE_INSENSITIVE_OP     0x0001  </span><span class="c1">// case insensitive comparison of strings</span>
<span class="cp">   #define FILTER_LAST_OP          0x0001  </span><span class="c1">// filter only last segment in OP_PATH repeating segment</span>
<span class="cp">   #define NOT_BOOLEAN_OP          0x0002  </span><span class="c1">// logical NOT of a boolean operation (e.g. NOT CONTAINS, DOESN&#39;T EXIST)</span>
<span class="cp">   #define DISTINCT_OP             0x0002  </span><span class="c1">// DICTINCT modifier for aggregate functions</span>
<span class="cp">   #define QUEST_PATH_OP           0x0002  </span><span class="c1">// OP_PATH: a.b{?}</span>
<span class="cp">   #define EXCLUDE_LBOUND_OP       0x0004  </span><span class="c1">// exclude lower bound in &#39;in [a,b]&#39;</span>
<span class="cp">   #define PLUS_PATH_OP            0x0004  </span><span class="c1">// OP_PATH: a.b{+}</span>
<span class="cp">   #define STAR_PATH_OP            0x0006  </span><span class="c1">// OP_PATH: a.b{*}</span>
<span class="cp">   #define EXCLUDE_RBOUND_OP       0x0008  </span><span class="c1">// exclude upper bound in &#39;in [a,b]&#39;</span>
<span class="cp">   #define FOR_ALL_LEFT_OP         0x0010  </span><span class="c1">// quantification of the left argument of a comparison</span>
<span class="cp">   #define EXISTS_LEFT_OP          0x0020  </span><span class="c1">// quantification of the left argument of a comparison</span>
<span class="cp">   #define FOR_ALL_RIGHT_OP        0x0040  </span><span class="c1">// quantification of the right argument of a comparison</span>
<span class="cp">   #define EXISTS_RIGHT_OP         0x0080  </span><span class="c1">// quantification of the right argument of a comparison</span>
<span class="cp">   #define NULLS_NOT_INCLUDED_OP   0x0100  </span><span class="c1">// missing property doesn&#39;t satisfy OP_NE (or !OP_EQ) condition</span>

    <span class="k">struct</span>   <span class="n">Value</span><span class="p">;</span>
    <span class="n">class</span>    <span class="n">IPIN</span><span class="p">;</span>
    <span class="n">class</span>    <span class="n">IStoreInspector</span><span class="p">;</span>

    <span class="k">struct</span> <span class="n">PID</span>
    <span class="p">{</span>
        <span class="kt">uint64_t</span>    <span class="n">pid</span><span class="p">;</span>
        <span class="n">IdentityID</span>   <span class="n">ident</span><span class="p">;</span>
        <span class="n">operator</span> <span class="kt">uint32_t</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="kt">uint32_t</span><span class="p">(</span><span class="n">pid</span><span class="o">&gt;&gt;</span><span class="mi">32</span><span class="p">)</span><span class="o">^</span><span class="kt">uint32_t</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span><span class="o">^</span><span class="n">ident</span><span class="p">;}</span>
        <span class="n">bool</span>     <span class="n">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="n">pid</span><span class="o">==</span><span class="n">rhs</span><span class="p">.</span><span class="n">pid</span> <span class="o">&amp;&amp;</span> <span class="n">ident</span><span class="o">==</span><span class="n">rhs</span><span class="p">.</span><span class="n">ident</span><span class="p">;}</span>
        <span class="n">bool</span>     <span class="n">operator</span><span class="o">!=</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="n">pid</span><span class="o">!=</span><span class="n">rhs</span><span class="p">.</span><span class="n">pid</span> <span class="o">||</span> <span class="n">ident</span><span class="o">!=</span><span class="n">rhs</span><span class="p">.</span><span class="n">ident</span><span class="p">;}</span>
        <span class="kt">void</span>        <span class="n">setStoreID</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">sid</span><span class="p">)</span> <span class="p">{</span><span class="n">pid</span><span class="o">=</span><span class="p">(</span><span class="n">pid</span><span class="o">&amp;</span><span class="mh">0x0000FFFFFFFFFFFFULL</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">48</span><span class="p">);}</span>
    <span class="p">};</span>

    <span class="k">struct</span> <span class="n">VPID</span>
    <span class="p">{</span>
        <span class="kt">uint64_t</span>    <span class="n">pid</span><span class="p">;</span>
        <span class="n">IdentityID</span>   <span class="n">ident</span><span class="p">;</span>
        <span class="n">VersionID</span>    <span class="n">vid</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">struct</span> <span class="n">RefP</span>
    <span class="p">{</span>
        <span class="n">IPIN</span>     <span class="o">*</span><span class="n">pin</span><span class="p">;</span>
        <span class="n">PropertyID</span>   <span class="n">pid</span><span class="p">;</span>
        <span class="n">ElementID</span>    <span class="n">eid</span><span class="p">;</span>
        <span class="n">VersionID</span>    <span class="n">vid</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">struct</span> <span class="n">RefVID</span>
    <span class="p">{</span>
        <span class="n">PID</span>          <span class="n">id</span><span class="p">;</span>
        <span class="n">PropertyID</span>   <span class="n">pid</span><span class="p">;</span>
        <span class="n">ElementID</span>    <span class="n">eid</span><span class="p">;</span>
        <span class="n">VersionID</span>    <span class="n">vid</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">IStream</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span> <span class="n">ValueType</span> <span class="n">dataType</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">uint64_t</span>    <span class="n">length</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="kt">size_t</span>       <span class="n">read</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">maxLength</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">size_t</span>      <span class="n">readChunk</span><span class="p">(</span><span class="kt">uint64_t</span> <span class="n">offset</span><span class="p">,</span><span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">length</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IStream</span>      <span class="o">*</span><span class="n">clone</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">reset</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="kt">void</span>     <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="k">struct</span>   <span class="n">IStreamRef</span> <span class="p">{</span>
        <span class="n">IStream</span>          <span class="o">*</span><span class="n">is</span><span class="p">;</span>
        <span class="n">mutable</span>  <span class="kt">void</span>    <span class="o">*</span><span class="n">prefix</span><span class="p">;</span>
    <span class="p">};</span>

<span class="cp">   #define VAR_TYPE_MASK   0xE000      </span><span class="c1">// mask for RefV::flags field</span>
<span class="cp">   #define VAR_PARAM       0x2000      </span><span class="c1">// external parameter reference; other bits reserved for internal use</span>

    <span class="k">struct</span> <span class="n">RefV</span>
    <span class="p">{</span>
        <span class="kt">unsigned</span>    <span class="kt">char</span>    <span class="n">refN</span><span class="p">;</span>
        <span class="kt">unsigned</span>    <span class="kt">char</span>    <span class="n">type</span><span class="p">;</span>
        <span class="kt">unsigned</span>    <span class="kt">short</span>   <span class="n">flags</span><span class="p">;</span>
        <span class="n">PropertyID</span>           <span class="n">id</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">enum</span> <span class="n">GO_DIR</span>
    <span class="p">{</span>
        <span class="n">GO_FIRST</span><span class="p">,</span><span class="n">GO_LAST</span><span class="p">,</span><span class="n">GO_NEXT</span><span class="p">,</span><span class="n">GO_PREVIOUS</span><span class="p">,</span><span class="n">GO_FINDBYID</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">INav</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span>  <span class="k">const</span>    <span class="n">Value</span>            <span class="o">*</span><span class="n">navigate</span><span class="p">(</span><span class="n">GO_DIR</span><span class="o">=</span><span class="n">GO_NEXT</span><span class="p">,</span><span class="n">ElementID</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>          <span class="n">ElementID</span>        <span class="n">getCurrentID</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="k">const</span>    <span class="n">Value</span>            <span class="o">*</span><span class="n">getCurrentValue</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>          <span class="n">RC</span>               <span class="n">getElementByID</span><span class="p">(</span><span class="n">ElementID</span><span class="p">,</span><span class="n">Value</span><span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">INav</span>                 <span class="o">*</span><span class="n">clone</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">unsigned</span> <span class="kt">long</span>           <span class="n">count</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>          <span class="kt">void</span>            <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">struct</span> <span class="n">IndexSeg</span>
    <span class="p">{</span>
        <span class="kt">uint32_t</span>    <span class="n">propID</span><span class="p">;</span>
        <span class="kt">uint16_t</span>    <span class="n">flags</span><span class="p">;</span>
        <span class="kt">uint16_t</span>    <span class="n">lPrefix</span><span class="p">;</span>
        <span class="kt">uint8_t</span>     <span class="n">type</span><span class="p">;</span>
        <span class="kt">uint8_t</span>     <span class="n">op</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="k">struct</span> <span class="n">StrEdit</span>
    <span class="p">{</span>
        <span class="k">union</span> <span class="p">{</span>
            <span class="k">const</span>    <span class="kt">char</span>        <span class="o">*</span><span class="n">str</span><span class="p">;</span>
            <span class="k">const</span>    <span class="kt">uint8_t</span>     <span class="o">*</span><span class="n">bstr</span><span class="p">;</span>
        <span class="p">};</span>
        <span class="kt">uint32_t</span>                <span class="n">length</span><span class="p">;</span>               <span class="c1">// shift+length must be &lt;= the length of the string being edited</span>
        <span class="kt">uint64_t</span>                <span class="n">shift</span><span class="p">;</span>                <span class="c1">// shift==~0ULL means &#39;end of string&#39;; in this case length must be 0</span>
    <span class="p">};</span>
    <span class="k">struct</span> <span class="n">QualifiedValue</span> <span class="p">{</span>
        <span class="kt">double</span>          <span class="n">d</span><span class="p">;</span>
        <span class="kt">uint16_t</span>        <span class="n">units</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">struct</span> <span class="n">Value</span>
    <span class="p">{</span>
                    <span class="n">PropertyID</span>   <span class="n">property</span><span class="p">;</span>
        <span class="n">mutable</span>      <span class="n">ElementID</span>    <span class="n">eid</span><span class="p">;</span>
                    <span class="kt">uint32_t</span>    <span class="n">length</span><span class="p">;</span>
                    <span class="kt">uint8_t</span>     <span class="n">type</span><span class="p">;</span>
                    <span class="kt">uint8_t</span>     <span class="n">op</span><span class="p">;</span>
                    <span class="kt">uint8_t</span>     <span class="n">meta</span><span class="p">;</span>
        <span class="n">mutable</span>      <span class="kt">uint8_t</span>     <span class="n">flags</span><span class="p">;</span>                <span class="c1">// for internal use only</span>
        <span class="k">union</span> <span class="p">{</span>
            <span class="k">const</span>    <span class="kt">char</span>        <span class="o">*</span><span class="n">str</span><span class="p">;</span>
            <span class="k">const</span>    <span class="kt">uint8_t</span>     <span class="o">*</span><span class="n">bstr</span><span class="p">;</span>
                    <span class="kt">int32_t</span>     <span class="n">i</span><span class="p">;</span>
                    <span class="kt">uint32_t</span>    <span class="n">ui</span><span class="p">;</span>
                    <span class="kt">int64_t</span>     <span class="n">i64</span><span class="p">;</span>
                    <span class="kt">uint64_t</span>    <span class="n">ui64</span><span class="p">;</span>
                    <span class="kt">float</span>       <span class="n">f</span><span class="p">;</span>
                    <span class="kt">double</span>      <span class="n">d</span><span class="p">;</span>
                    <span class="n">PID</span>          <span class="n">id</span><span class="p">;</span>
                    <span class="n">VPID</span>     <span class="n">vpid</span><span class="p">;</span>
                    <span class="n">IPIN</span>     <span class="o">*</span><span class="n">pin</span><span class="p">;</span>
            <span class="k">const</span>    <span class="n">RefVID</span>       <span class="o">*</span><span class="n">refId</span><span class="p">;</span>
                    <span class="n">RefP</span>     <span class="n">ref</span><span class="p">;</span>
            <span class="k">const</span>    <span class="n">Value</span>        <span class="o">*</span><span class="n">varray</span><span class="p">;</span>
                    <span class="n">INav</span>     <span class="o">*</span><span class="n">nav</span><span class="p">;</span>
                    <span class="n">Value</span>        <span class="o">*</span><span class="n">range</span><span class="p">;</span>
                    <span class="n">bool</span>     <span class="n">b</span><span class="p">;</span>
                    <span class="n">URIID</span>        <span class="n">uid</span><span class="p">;</span>
                    <span class="n">IdentityID</span>   <span class="n">iid</span><span class="p">;</span>
                    <span class="n">IStreamRef</span>   <span class="n">stream</span><span class="p">;</span>
            <span class="n">class</span>    <span class="n">IStmt</span>        <span class="o">*</span><span class="n">stmt</span><span class="p">;</span>
            <span class="n">class</span>    <span class="n">IExpr</span>        <span class="o">*</span><span class="n">expr</span><span class="p">;</span>
            <span class="n">class</span>    <span class="n">IExprTree</span>    <span class="o">*</span><span class="n">exprt</span><span class="p">;</span>
                    <span class="n">RefV</span>     <span class="n">refV</span><span class="p">;</span>
                    <span class="n">StrEdit</span>      <span class="n">edit</span><span class="p">;</span>
                    <span class="n">IndexSeg</span> <span class="n">iseg</span><span class="p">;</span>
            <span class="n">QualifiedValue</span>       <span class="n">qval</span><span class="p">;</span>
        <span class="p">};</span>
    <span class="nl">public:</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_STRING</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">s</span><span class="o">==</span><span class="nb">NULL</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">str</span><span class="o">=</span><span class="n">s</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">nChars</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_STRING</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">nChars</span><span class="p">;</span> <span class="n">str</span><span class="o">=</span><span class="n">s</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">bs</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_BSTR</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">l</span><span class="p">;</span> <span class="n">bstr</span><span class="o">=</span><span class="n">bs</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setURL</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_URL</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">s</span><span class="o">==</span><span class="nb">NULL</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">str</span><span class="o">=</span><span class="n">s</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setURL</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">nChars</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_URL</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">nChars</span><span class="p">;</span> <span class="n">str</span><span class="o">=</span><span class="n">s</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="kt">int</span> <span class="n">ii</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_INT</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int32_t</span><span class="p">);</span> <span class="n">i</span><span class="o">=</span><span class="n">ii</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_UINT</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">);</span> <span class="n">ui</span><span class="o">=</span><span class="n">u</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setI64</span><span class="p">(</span><span class="kt">int64_t</span> <span class="n">ii</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_INT64</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int64_t</span><span class="p">);</span> <span class="n">i64</span><span class="o">=</span><span class="n">ii</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setU64</span><span class="p">(</span><span class="kt">uint64_t</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_UINT64</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">);</span> <span class="n">ui64</span><span class="o">=</span><span class="n">u</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="kt">float</span> <span class="n">fl</span><span class="p">,</span><span class="n">Units</span> <span class="n">pu</span><span class="o">=</span><span class="n">Un_NDIM</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_FLOAT</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">);</span> <span class="n">f</span><span class="o">=</span><span class="n">fl</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">qval</span><span class="p">.</span><span class="n">units</span><span class="o">=</span><span class="p">(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="n">pu</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="kt">double</span> <span class="n">dd</span><span class="p">,</span><span class="n">Units</span> <span class="n">pu</span><span class="o">=</span><span class="n">Un_NDIM</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_DOUBLE</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">);</span> <span class="n">d</span><span class="o">=</span><span class="n">dd</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">qval</span><span class="p">.</span><span class="n">units</span><span class="o">=</span><span class="p">(</span><span class="kt">uint16_t</span><span class="p">)</span><span class="n">pu</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="n">IPIN</span> <span class="o">*</span><span class="n">ip</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_REF</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="n">IPIN</span><span class="o">*</span><span class="p">);</span> <span class="n">pin</span><span class="o">=</span><span class="n">ip</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">pi</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_REFID</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="n">PID</span><span class="p">);</span> <span class="n">id</span><span class="o">=</span><span class="n">pi</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="k">const</span> <span class="n">RefVID</span><span class="o">&amp;</span> <span class="n">re</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="kt">uint8_t</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="n">eid</span><span class="o">==</span><span class="n">STORE_COLLECTION_ID</span><span class="o">?</span><span class="n">VT_REFIDPROP</span><span class="o">:</span><span class="n">VT_REFIDELT</span><span class="p">);</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">refId</span><span class="o">=&amp;</span><span class="n">re</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="k">const</span> <span class="n">RefP</span><span class="o">&amp;</span> <span class="n">re</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="kt">uint8_t</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="n">eid</span><span class="o">==</span><span class="n">STORE_COLLECTION_ID</span><span class="o">?</span><span class="n">VT_REFPROP</span><span class="o">:</span><span class="n">VT_REFELT</span><span class="p">);</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">ref</span><span class="o">=</span><span class="n">re</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="n">Value</span> <span class="o">*</span><span class="n">coll</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">nValues</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_ARRAY</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">nValues</span><span class="p">;</span> <span class="n">varray</span><span class="o">=</span><span class="n">coll</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="n">INav</span> <span class="o">*</span><span class="n">nv</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_COLLECTION</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">nav</span><span class="o">=</span><span class="n">nv</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setStruct</span><span class="p">(</span><span class="n">Value</span> <span class="o">*</span><span class="n">coll</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">nValues</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_STRUCT</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">nValues</span><span class="p">;</span> <span class="n">varray</span><span class="o">=</span><span class="n">coll</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="n">bool</span> <span class="n">bl</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_BOOL</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="n">bool</span><span class="p">);</span> <span class="n">b</span><span class="o">=</span><span class="n">bl</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setDateTime</span><span class="p">(</span><span class="kt">uint64_t</span> <span class="n">datetime</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_DATETIME</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">);</span> <span class="n">ui64</span><span class="o">=</span><span class="n">datetime</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setInterval</span><span class="p">(</span><span class="kt">int64_t</span> <span class="n">intvl</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_INTERVAL</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int64_t</span><span class="p">);</span> <span class="n">i64</span><span class="o">=</span><span class="n">intvl</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="n">IStream</span> <span class="o">*</span><span class="n">strm</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_STREAM</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">stream</span><span class="p">.</span><span class="n">is</span><span class="o">=</span><span class="n">strm</span><span class="p">;</span> <span class="n">stream</span><span class="p">.</span><span class="n">prefix</span><span class="o">=</span><span class="nb">NULL</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="n">IStmt</span> <span class="o">*</span><span class="n">stm</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_STMT</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">stmt</span><span class="o">=</span><span class="n">stm</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="n">IExprTree</span> <span class="o">*</span><span class="n">ex</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_EXPRTREE</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">exprt</span><span class="o">=</span><span class="n">ex</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">set</span><span class="p">(</span><span class="n">IExpr</span> <span class="o">*</span><span class="n">ex</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_EXPR</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">expr</span><span class="o">=</span><span class="n">ex</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setParam</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">pn</span><span class="p">,</span><span class="n">ValueType</span> <span class="n">ty</span><span class="o">=</span><span class="n">VT_ANY</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">f</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_VARREF</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">refV</span><span class="p">.</span><span class="n">refN</span><span class="o">=</span><span class="n">pn</span><span class="p">;</span> <span class="n">refV</span><span class="p">.</span><span class="n">type</span><span class="o">=</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">)</span><span class="n">ty</span><span class="p">;</span> <span class="n">refV</span><span class="p">.</span><span class="n">flags</span><span class="o">=</span><span class="n">f</span><span class="o">&amp;~</span><span class="n">VAR_TYPE_MASK</span><span class="o">|</span><span class="n">VAR_PARAM</span><span class="p">;</span> <span class="n">refV</span><span class="p">.</span><span class="n">id</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setVarRef</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">vn</span><span class="p">,</span><span class="n">PropertyID</span> <span class="n">id</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">,</span><span class="n">ValueType</span> <span class="n">ty</span><span class="o">=</span><span class="n">VT_ANY</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">f</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_VARREF</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">id</span><span class="o">!=</span><span class="n">STORE_INVALID_PROPID</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">;</span> <span class="n">refV</span><span class="p">.</span><span class="n">refN</span><span class="o">=</span><span class="n">vn</span><span class="p">;</span> <span class="n">refV</span><span class="p">.</span><span class="n">type</span><span class="o">=</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">)</span><span class="n">ty</span><span class="p">;</span> <span class="n">refV</span><span class="p">.</span><span class="n">flags</span><span class="o">=</span><span class="n">f</span><span class="o">&amp;~</span><span class="n">VAR_TYPE_MASK</span><span class="p">;</span> <span class="n">refV</span><span class="p">.</span><span class="n">id</span><span class="o">=</span><span class="n">id</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setRange</span><span class="p">(</span><span class="n">Value</span> <span class="o">*</span><span class="n">rng</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_RANGE</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">range</span><span class="o">=</span><span class="n">rng</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setURIID</span><span class="p">(</span><span class="n">URIID</span> <span class="n">uri</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_URIID</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">);</span> <span class="n">uid</span><span class="o">=</span><span class="n">uri</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setIdentity</span><span class="p">(</span><span class="n">IdentityID</span> <span class="n">ii</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_IDENTITY</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">);</span> <span class="n">iid</span><span class="o">=</span><span class="n">ii</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setNow</span><span class="p">()</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_CURRENT</span><span class="p">;</span> <span class="n">i</span><span class="o">=</span><span class="n">CVT_TIMESTAMP</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setCUser</span><span class="p">()</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_CURRENT</span><span class="p">;</span> <span class="n">i</span><span class="o">=</span><span class="n">CVT_USER</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setCStore</span><span class="p">()</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_CURRENT</span><span class="p">;</span> <span class="n">i</span><span class="o">=</span><span class="n">CVT_STORE</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setEdit</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="kt">uint64_t</span> <span class="n">sht</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_STRING</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_EDIT</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">s</span><span class="o">==</span><span class="nb">NULL</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">edit</span><span class="p">.</span><span class="n">str</span><span class="o">=</span><span class="n">s</span><span class="p">;</span> <span class="n">edit</span><span class="p">.</span><span class="n">shift</span><span class="o">=</span><span class="n">sht</span><span class="p">;</span> <span class="n">edit</span><span class="p">.</span><span class="n">length</span><span class="o">=</span><span class="n">l</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setEdit</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">nChars</span><span class="p">,</span><span class="kt">uint64_t</span> <span class="n">sht</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_STRING</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_EDIT</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">nChars</span><span class="p">;</span> <span class="n">edit</span><span class="p">.</span><span class="n">str</span><span class="o">=</span><span class="n">s</span><span class="p">;</span> <span class="n">edit</span><span class="p">.</span><span class="n">shift</span><span class="o">=</span><span class="n">sht</span><span class="p">;</span> <span class="n">edit</span><span class="p">.</span><span class="n">length</span><span class="o">=</span><span class="n">l</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setEdit</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">bs</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">l</span><span class="p">,</span><span class="kt">uint64_t</span> <span class="n">sht</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">ll</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_BSTR</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_EDIT</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="n">l</span><span class="p">;</span> <span class="n">edit</span><span class="p">.</span><span class="n">bstr</span><span class="o">=</span><span class="n">bs</span><span class="p">;</span> <span class="n">edit</span><span class="p">.</span><span class="n">shift</span><span class="o">=</span><span class="n">sht</span><span class="p">;</span> <span class="n">edit</span><span class="p">.</span><span class="n">length</span><span class="o">=</span><span class="n">ll</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setPart</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">)</span> <span class="p">{</span><span class="n">set</span><span class="p">(</span><span class="n">id</span><span class="p">);</span> <span class="n">meta</span><span class="o">|=</span><span class="n">META_PROP_PART</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setPart</span><span class="p">(</span><span class="n">IPIN</span> <span class="o">*</span><span class="n">pin</span><span class="p">)</span> <span class="p">{</span><span class="n">set</span><span class="p">(</span><span class="n">pin</span><span class="p">);</span> <span class="n">meta</span><span class="o">|=</span><span class="n">META_PROP_PART</span><span class="p">;}</span> 
        <span class="kt">void</span>    <span class="nf">setRename</span><span class="p">(</span><span class="n">PropertyID</span> <span class="n">from</span><span class="p">,</span><span class="n">PropertyID</span> <span class="n">to</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_URIID</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">from</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_RENAME</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="k">sizeof</span><span class="p">(</span><span class="n">PropertyID</span><span class="p">);</span> <span class="n">uid</span><span class="o">=</span><span class="n">to</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setDelete</span><span class="p">(</span><span class="n">PropertyID</span> <span class="n">p</span><span class="p">,</span><span class="n">ElementID</span> <span class="n">ei</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_ANY</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">p</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_DELETE</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">ei</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
        <span class="kt">void</span>    <span class="nf">setError</span><span class="p">(</span><span class="n">PropertyID</span> <span class="n">pid</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">)</span> <span class="p">{</span><span class="n">type</span><span class="o">=</span><span class="n">VT_ERROR</span><span class="p">;</span> <span class="n">property</span><span class="o">=</span><span class="n">pid</span><span class="p">;</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">op</span><span class="o">=</span><span class="n">OP_SET</span><span class="p">;</span> <span class="n">eid</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">;</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">meta</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>

        <span class="kt">void</span>        <span class="nf">setOp</span><span class="p">(</span><span class="n">ExprOp</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span><span class="n">op</span><span class="o">=</span><span class="kt">uint8_t</span><span class="p">(</span><span class="n">o</span><span class="p">);}</span>
        <span class="kt">void</span>        <span class="nf">setMeta</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">mt</span><span class="p">)</span> <span class="p">{</span><span class="n">meta</span><span class="o">=</span><span class="n">mt</span><span class="p">;}</span>
        <span class="kt">void</span>        <span class="nf">setPropID</span><span class="p">(</span><span class="n">PropertyID</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span><span class="n">property</span><span class="o">=</span><span class="n">p</span><span class="p">;}</span>
        <span class="n">PropertyID</span>   <span class="n">getPropID</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="n">property</span><span class="p">;}</span>
        <span class="n">bool</span>     <span class="n">isFTIndexable</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="n">type</span><span class="o">==</span><span class="n">VT_STRING</span> <span class="o">||</span> <span class="p">(</span><span class="n">type</span><span class="o">==</span><span class="n">VT_STREAM</span> <span class="o">&amp;&amp;</span> <span class="n">stream</span><span class="p">.</span><span class="n">is</span><span class="o">-&gt;</span><span class="n">dataType</span><span class="p">()</span><span class="o">==</span><span class="n">VT_STRING</span><span class="p">);}</span>
    <span class="p">};</span>

    <span class="cm">/**</span>
<span class="cm">    * The main interface to manipulate PINs.</span>
<span class="cm">    * Allows to enumerate all properties of a PIN, as well as to</span>
<span class="cm">    * create, query, modify and delete properties.</span>
<span class="cm">    * @see ISession</span>
<span class="cm">    */</span>
    
    <span class="n">class</span> <span class="n">MV_EXP</span> <span class="n">IPIN</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span>  <span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">getPID</span><span class="p">()</span> <span class="k">const</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">isLocal</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">isCommitted</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">isReadonly</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">canNotify</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">isReplicated</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">canBeReplicated</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">isHidden</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">isDeleted</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">isClass</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">isDerived</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">isProjected</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="kt">uint32_t</span>    <span class="n">getNumberOfProperties</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="k">const</span> <span class="n">Value</span>   <span class="o">*</span><span class="n">getValueByIndex</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">idx</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="k">const</span> <span class="n">Value</span>   <span class="o">*</span><span class="n">getValue</span><span class="p">(</span><span class="n">PropertyID</span> <span class="n">pid</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">getPINValue</span><span class="p">(</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="kt">uint32_t</span> <span class="n">getStamp</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">char</span>        <span class="o">*</span><span class="n">getURI</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">testClassMembership</span><span class="p">(</span><span class="n">ClassID</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">params</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nParams</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">defined</span><span class="p">(</span><span class="k">const</span> <span class="n">PropertyID</span> <span class="o">*</span><span class="n">pids</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nProps</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">refresh</span><span class="p">(</span><span class="n">bool</span> <span class="n">fNet</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IPIN</span>     <span class="o">*</span><span class="n">clone</span><span class="p">(</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">overwriteValues</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nOverwriteValues</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IPIN</span>     <span class="o">*</span><span class="n">project</span><span class="p">(</span><span class="k">const</span> <span class="n">PropertyID</span> <span class="o">*</span><span class="n">properties</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nProperties</span><span class="p">,</span><span class="k">const</span> <span class="n">PropertyID</span> <span class="o">*</span><span class="n">newProps</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">modify</span><span class="p">(</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">values</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nValues</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">ElementID</span> <span class="o">*</span><span class="n">eids</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="o">*</span><span class="n">pNFailed</span><span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setExpiration</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setNotification</span><span class="p">(</span><span class="n">bool</span> <span class="n">fReset</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setReplicated</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setNoIndex</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">deletePIN</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">undelete</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="k">struct</span> <span class="n">QName</span>
    <span class="p">{</span>
        <span class="k">const</span>    <span class="kt">char</span>    <span class="o">*</span><span class="n">qpref</span><span class="p">;</span>
        <span class="kt">size_t</span>          <span class="n">lq</span><span class="p">;</span>
        <span class="k">const</span>    <span class="kt">char</span>    <span class="o">*</span><span class="n">str</span><span class="p">;</span>
        <span class="kt">size_t</span>          <span class="n">lstr</span><span class="p">;</span>
        <span class="n">bool</span>         <span class="n">fDel</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">struct</span> <span class="n">MV_EXP</span> <span class="n">CompilationError</span>
    <span class="p">{</span>
        <span class="n">RC</span>               <span class="n">rc</span><span class="p">;</span>
        <span class="k">const</span>    <span class="kt">char</span>    <span class="o">*</span><span class="n">msg</span><span class="p">;</span>
        <span class="kt">unsigned</span>        <span class="n">line</span><span class="p">;</span>
        <span class="kt">unsigned</span>        <span class="n">pos</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">MV_EXP</span> <span class="n">IExprTree</span> 
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span> <span class="n">ExprOp</span>            <span class="n">getOp</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">unsigned</span>        <span class="n">getNumberOfOperands</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="k">const</span>    <span class="n">Value</span><span class="o">&amp;</span>    <span class="n">getOperand</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">idx</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">unsigned</span>        <span class="n">getFlags</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>            <span class="n">setFlags</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">flags</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mask</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IExpr</span>            <span class="o">*</span><span class="n">compile</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">char</span>            <span class="o">*</span><span class="n">toString</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="k">const</span> <span class="n">QName</span> <span class="o">*</span><span class="n">qNames</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nQNames</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="n">IExprTree</span>     <span class="o">*</span><span class="n">clone</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>            <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">MV_EXP</span> <span class="n">IExpr</span> 
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">execute</span><span class="p">(</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">params</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nParams</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">char</span>        <span class="o">*</span><span class="n">toString</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="k">const</span> <span class="n">QName</span> <span class="o">*</span><span class="n">qNames</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nQNames</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="n">IExpr</span>     <span class="o">*</span><span class="n">clone</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">MV_EXP</span> <span class="n">ICursor</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span>  <span class="n">IPIN</span>     <span class="o">*</span><span class="n">next</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">next</span><span class="p">(</span><span class="n">PID</span><span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">next</span><span class="p">(</span><span class="n">IPIN</span> <span class="o">*</span><span class="n">pins</span><span class="p">[],</span><span class="kt">unsigned</span> <span class="n">nPins</span><span class="p">,</span><span class="kt">unsigned</span><span class="o">&amp;</span> <span class="n">nRet</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">rewind</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">uint64_t</span>    <span class="n">getCount</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">MV_EXP</span> <span class="n">IStreamOut</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">next</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="kt">size_t</span><span class="o">&amp;</span> <span class="n">lBuf</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>    <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>
    
    <span class="n">class</span> <span class="n">MV_EXP</span> <span class="n">IStreamIn</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">next</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">lBuf</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>    <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

<span class="cp">   #define QFT_FILTER_SW       0x0001</span>
<span class="cp">   #define QFT_RET_NO_DOC      0x0002</span>
<span class="cp">   #define QFT_RET_PARTS       0x0004</span>
<span class="cp">   #define QFT_RET_NO_PARTS    0x0008</span>

    <span class="k">enum</span> <span class="n">QUERY_SETOP</span>
    <span class="p">{</span>
        <span class="n">QRY_JOIN</span><span class="p">,</span> <span class="n">QRY_LEFTJOIN</span><span class="p">,</span> <span class="n">QRY_RIGHTJOIN</span><span class="p">,</span> <span class="n">QRY_OUTERJOIN</span><span class="p">,</span> <span class="n">QRY_UNION</span><span class="p">,</span> <span class="n">QRY_EXCEPT</span><span class="p">,</span> <span class="n">QRY_INTERSECT</span><span class="p">,</span> <span class="n">QRY_ALL_SETOP</span>
    <span class="p">};</span>

<span class="cp">   #define CLASS_PARAM_REF     0x80000000</span>

    <span class="k">struct</span>   <span class="n">ClassSpec</span>
    <span class="p">{</span>
        <span class="n">ClassID</span>          <span class="n">classID</span><span class="p">;</span>
        <span class="kt">unsigned</span>        <span class="n">nParams</span><span class="p">;</span>
        <span class="k">const</span>    <span class="n">Value</span>    <span class="o">*</span><span class="n">params</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">struct</span> <span class="n">PathSeg</span>
    <span class="p">{</span>
        <span class="n">PropertyID</span>       <span class="n">pid</span><span class="p">;</span>
        <span class="n">ElementID</span>        <span class="n">eid</span><span class="p">;</span>
        <span class="n">IExpr</span>            <span class="o">*</span><span class="n">filter</span><span class="p">;</span>
        <span class="n">ClassID</span>          <span class="n">cls</span><span class="p">;</span>
        <span class="kt">unsigned</span>        <span class="n">rmin</span><span class="p">;</span>
        <span class="kt">unsigned</span>        <span class="n">rmax</span><span class="p">;</span>
        <span class="n">bool</span>         <span class="n">fLast</span><span class="p">;</span>
    <span class="p">};</span>

<span class="cp">   #define ORD_DESC            0x01</span>
<span class="cp">   #define ORD_NCASE           0x02</span>
<span class="cp">   #define ORD_NULLS_BEFORE    0x04</span>
<span class="cp">   #define ORD_NULLS_AFTER     0x08</span>

    <span class="k">struct</span>   <span class="n">OrderSeg</span>
    <span class="p">{</span>
        <span class="n">IExprTree</span>    <span class="o">*</span><span class="n">expr</span><span class="p">;</span>
        <span class="n">PropertyID</span>   <span class="n">pid</span><span class="p">;</span>
        <span class="kt">uint8_t</span>     <span class="n">flags</span><span class="p">;</span>
        <span class="kt">uint8_t</span>     <span class="n">var</span><span class="p">;</span>
        <span class="kt">uint16_t</span>    <span class="n">lPrefix</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">typedef</span>  <span class="kt">unsigned</span>    <span class="kt">char</span>    <span class="n">QVarID</span><span class="p">;</span>
<span class="cp">   #define INVALID_QVAR_ID     0xFF</span>

    <span class="k">enum</span> <span class="n">STMT_OP</span>
    <span class="p">{</span>
        <span class="n">STMT_QUERY</span><span class="p">,</span> <span class="n">STMT_INSERT</span><span class="p">,</span> <span class="n">STMT_UPDATE</span><span class="p">,</span> <span class="n">STMT_DELETE</span><span class="p">,</span> <span class="n">STMT_UNDELETE</span><span class="p">,</span> <span class="n">STMT_START_TX</span><span class="p">,</span> <span class="n">STMT_COMMIT</span><span class="p">,</span> <span class="n">STMT_ROLLBACK</span><span class="p">,</span> <span class="n">STMT_ISOLATION</span><span class="p">,</span> <span class="n">STMT_PREFIX</span><span class="p">,</span> <span class="n">STMT_OP_ALL</span>
    <span class="p">};</span>
    
    <span class="k">enum</span> <span class="n">DistinctType</span>
    <span class="p">{</span>
        <span class="n">DT_DEFAULT</span><span class="p">,</span> <span class="n">DT_ALL</span><span class="p">,</span> <span class="n">DT_DISTINCT</span><span class="p">,</span> <span class="n">DT_DISTINCT_VALUES</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">IStmtCallback</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span>  <span class="kt">void</span>    <span class="n">result</span><span class="p">(</span><span class="n">ICursor</span> <span class="o">*</span><span class="n">res</span><span class="p">,</span><span class="n">RC</span> <span class="n">rc</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">MV_EXP</span> <span class="n">IStmt</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span> <span class="n">QVarID</span>    <span class="n">addVariable</span><span class="p">(</span><span class="k">const</span> <span class="n">ClassSpec</span> <span class="o">*</span><span class="n">classes</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nClasses</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">IExprTree</span> <span class="o">*</span><span class="n">cond</span><span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="n">QVarID</span>    <span class="n">addVariable</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">pid</span><span class="p">,</span><span class="n">PropertyID</span> <span class="n">propID</span><span class="p">,</span><span class="n">IExprTree</span> <span class="o">*</span><span class="n">cond</span><span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="n">QVarID</span>    <span class="n">addVariable</span><span class="p">(</span><span class="n">IStmt</span> <span class="o">*</span><span class="n">qry</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">QVarID</span>   <span class="n">setOp</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">leftVar</span><span class="p">,</span><span class="n">QVarID</span> <span class="n">rightVar</span><span class="p">,</span><span class="n">QUERY_SETOP</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">QVarID</span>   <span class="n">setOp</span><span class="p">(</span><span class="k">const</span> <span class="n">QVarID</span> <span class="o">*</span><span class="n">vars</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nVars</span><span class="p">,</span><span class="n">QUERY_SETOP</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">QVarID</span>   <span class="n">join</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">leftVar</span><span class="p">,</span><span class="n">QVarID</span> <span class="n">rightVar</span><span class="p">,</span><span class="n">IExprTree</span> <span class="o">*</span><span class="n">cond</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="n">QUERY_SETOP</span><span class="o">=</span><span class="n">QRY_JOIN</span><span class="p">,</span><span class="n">PropertyID</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">QVarID</span>   <span class="n">join</span><span class="p">(</span><span class="k">const</span> <span class="n">QVarID</span> <span class="o">*</span><span class="n">vars</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nVars</span><span class="p">,</span><span class="n">IExprTree</span> <span class="o">*</span><span class="n">cond</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="n">QUERY_SETOP</span><span class="o">=</span><span class="n">QRY_JOIN</span><span class="p">,</span><span class="n">PropertyID</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">setName</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">var</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">setDistinct</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">var</span><span class="p">,</span><span class="n">DistinctType</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">addOutput</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">var</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">dscr</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nDscr</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span> <span class="n">RC</span>        <span class="n">addCondition</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">var</span><span class="p">,</span><span class="n">IExprTree</span> <span class="o">*</span><span class="n">cond</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">addConditionFT</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">var</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="k">const</span> <span class="n">PropertyID</span> <span class="o">*</span><span class="n">pids</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nPids</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">setPIDs</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">var</span><span class="p">,</span><span class="k">const</span> <span class="n">PID</span> <span class="o">*</span><span class="n">pids</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nPids</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">setPath</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">var</span><span class="p">,</span><span class="k">const</span> <span class="n">PathSeg</span> <span class="o">*</span><span class="n">segs</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nSegs</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">setPropCondition</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">var</span><span class="p">,</span><span class="k">const</span> <span class="n">PropertyID</span> <span class="o">*</span><span class="n">props</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nProps</span><span class="p">,</span><span class="n">bool</span> <span class="n">fOr</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">setJoinProperties</span><span class="p">(</span><span class="n">QVarID</span> <span class="n">var</span><span class="p">,</span><span class="k">const</span> <span class="n">PropertyID</span> <span class="o">*</span><span class="n">props</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nProps</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">setGroup</span><span class="p">(</span><span class="n">QVarID</span><span class="p">,</span><span class="k">const</span> <span class="n">OrderSeg</span> <span class="o">*</span><span class="n">order</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nSegs</span><span class="p">,</span><span class="n">IExprTree</span> <span class="o">*</span><span class="n">having</span><span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">setOrder</span><span class="p">(</span><span class="k">const</span> <span class="n">OrderSeg</span> <span class="o">*</span><span class="n">order</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nSegs</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">setValues</span><span class="p">(</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">values</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nValues</span><span class="p">)</span> <span class="o">=</span>  <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">STMT_OP</span>  <span class="n">getOp</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">execute</span><span class="p">(</span><span class="n">ICursor</span> <span class="o">**</span><span class="n">result</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">params</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nParams</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nProcess</span><span class="o">=~</span><span class="mi">0u</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nSkip</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                        <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">uint64_t</span> <span class="o">*</span><span class="n">nProcessed</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="n">TXI_LEVEL</span><span class="o">=</span><span class="n">TXI_DEFAULT</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">asyncexec</span><span class="p">(</span><span class="n">IStmtCallback</span> <span class="o">*</span><span class="n">cb</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">params</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nParams</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nProcess</span><span class="o">=~</span><span class="mi">0u</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nSkip</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                        <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">TXI_LEVEL</span><span class="o">=</span><span class="n">TXI_DEFAULT</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">execute</span><span class="p">(</span><span class="n">IStreamOut</span><span class="o">*&amp;</span> <span class="n">result</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">params</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nParams</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nProcess</span><span class="o">=~</span><span class="mi">0u</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nSkip</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                        <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">TXI_LEVEL</span><span class="o">=</span><span class="n">TXI_DEFAULT</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">count</span><span class="p">(</span><span class="kt">uint64_t</span><span class="o">&amp;</span> <span class="n">cnt</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">params</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nParams</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">nAbort</span><span class="o">=~</span><span class="mi">0u</span><span class="p">,</span>
                                        <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">TXI_LEVEL</span><span class="o">=</span><span class="n">TXI_DEFAULT</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">exist</span><span class="p">(</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">params</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nParams</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">TXI_LEVEL</span><span class="o">=</span><span class="n">TXI_DEFAULT</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">analyze</span><span class="p">(</span><span class="kt">char</span> <span class="o">*&amp;</span><span class="n">plan</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">pars</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nPars</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">md</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">bool</span> <span class="n">isSatisfied</span><span class="p">(</span><span class="k">const</span> <span class="n">IPIN</span> <span class="o">*</span><span class="n">pin</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">pars</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nPars</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span> <span class="n">isSatisfied</span><span class="p">(</span><span class="k">const</span> <span class="n">IPIN</span> <span class="o">*</span><span class="k">const</span> <span class="o">*</span><span class="n">pins</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nPins</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">pars</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nPars</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">char</span>    <span class="o">*</span><span class="n">toString</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="k">const</span> <span class="n">QName</span> <span class="o">*</span><span class="n">qNames</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nQNames</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">IStmt</span>    <span class="o">*</span><span class="n">clone</span><span class="p">(</span><span class="n">STMT_OP</span><span class="o">=</span><span class="n">STMT_OP_ALL</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>    <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="cm">/**</span>
<span class="cm">    * Full identification of properties.</span>
<span class="cm">    * @see ISession</span>
<span class="cm">    */</span>
    <span class="k">struct</span> <span class="n">URIMap</span>
    <span class="p">{</span>
        <span class="k">const</span>        <span class="kt">char</span>    <span class="o">*</span><span class="n">URI</span><span class="p">;</span>
        <span class="n">URIID</span>                <span class="n">uid</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">struct</span> <span class="n">AllocCtrl</span>
    <span class="p">{</span>
        <span class="kt">unsigned</span> <span class="kt">long</span>   <span class="n">arrayThreshold</span><span class="p">;</span>
        <span class="kt">size_t</span>          <span class="n">ssvThreshold</span><span class="p">;</span>
        <span class="kt">float</span>           <span class="n">pctPageFree</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">IndexNav</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">next</span><span class="p">(</span><span class="n">PID</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">,</span><span class="n">GO_DIR</span><span class="o">=</span><span class="n">GO_NEXT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">position</span><span class="p">(</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">pv</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nValues</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>       <span class="n">getValue</span><span class="p">(</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*&amp;</span><span class="n">pv</span><span class="p">,</span><span class="kt">unsigned</span><span class="o">&amp;</span> <span class="n">nValues</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="k">const</span> <span class="n">Value</span>   <span class="o">*</span><span class="n">next</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">unsigned</span> <span class="n">nValues</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>    <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">StringEnum</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span>  <span class="k">const</span> <span class="kt">char</span>   <span class="o">*</span><span class="n">next</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">destroy</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">ITrace</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">virtual</span>  <span class="kt">void</span>    <span class="n">trace</span><span class="p">(</span><span class="kt">long</span> <span class="n">code</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">msg</span><span class="p">,</span><span class="kt">va_list</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="cm">/**</span>
<span class="cm">    * The session encapsulates a client&#39;s connection to the store.</span>
<span class="cm">    * Through it, the client can create, query, modify and delete PINs,</span>
<span class="cm">    * in a transactioned manner.  This is also where the client</span>
<span class="cm">    * can map PropIDs to full property information (e.g. names).</span>
<span class="cm">    * Note:</span>
<span class="cm">    *  A command executed outside a transaction is implicitly</span>
<span class="cm">    *  executed in its own transaction.</span>
<span class="cm">    * @see IPIN</span>
<span class="cm">    */</span>
    <span class="n">class</span> <span class="n">MV_EXP</span> <span class="n">ISession</span>
    <span class="p">{</span>
        <span class="kt">void</span>    <span class="n">operator</span> <span class="n">delete</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span> <span class="p">{}</span>
    <span class="nl">public:</span>
        <span class="k">static</span>   <span class="n">ISession</span> <span class="o">*</span><span class="n">startSession</span><span class="p">(</span><span class="n">MVStoreCtx</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">identityName</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">password</span><span class="o">=</span><span class="nb">NULL</span><span class="p">);</span>
        <span class="k">virtual</span>  <span class="n">ISession</span> <span class="o">*</span><span class="n">clone</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">attachToCurrentThread</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">detachFromCurrentThread</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">setInterfaceMode</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">flags</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">unsigned</span>    <span class="n">getInterfaceMode</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setURIBase</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">URIBase</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">addURIPrefix</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">URIprefix</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">setDefaultExpiration</span><span class="p">(</span><span class="kt">uint64_t</span> <span class="n">defExp</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">changeTraceMode</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">mask</span><span class="p">,</span><span class="n">bool</span> <span class="n">fReset</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">setTrace</span><span class="p">(</span><span class="n">ITrace</span> <span class="o">*</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">terminate</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">mapURIs</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">nURIs</span><span class="p">,</span><span class="n">URIMap</span> <span class="n">URIs</span><span class="p">[])</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">getURI</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">,</span><span class="kt">char</span> <span class="n">buf</span><span class="p">[],</span><span class="kt">size_t</span><span class="o">&amp;</span> <span class="n">lbuf</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">IdentityID</span>   <span class="n">getCurrentIdentityID</span><span class="p">()</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IdentityID</span>   <span class="n">getIdentityID</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">identity</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">impersonate</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">identity</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IdentityID</span>   <span class="n">storeIdentity</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">identity</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pwd</span><span class="p">,</span><span class="n">bool</span> <span class="n">fMayInsert</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cert</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">lcert</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IdentityID</span>   <span class="n">loadIdentity</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">identity</span><span class="p">,</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pwd</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">lPwd</span><span class="p">,</span><span class="n">bool</span> <span class="n">fMayInsert</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cert</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">lcert</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setInsertPermission</span><span class="p">(</span><span class="n">IdentityID</span><span class="p">,</span><span class="n">bool</span> <span class="n">fMayInsert</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
        <span class="k">virtual</span>  <span class="kt">size_t</span>      <span class="n">getStoreIdentityName</span><span class="p">(</span><span class="kt">char</span> <span class="n">buf</span><span class="p">[],</span><span class="kt">size_t</span> <span class="n">lbuf</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">size_t</span>      <span class="n">getIdentityName</span><span class="p">(</span><span class="n">IdentityID</span><span class="p">,</span><span class="kt">char</span> <span class="n">buf</span><span class="p">[],</span><span class="kt">size_t</span> <span class="n">lbuf</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">size_t</span>      <span class="n">getCertificate</span><span class="p">(</span><span class="n">IdentityID</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">buf</span><span class="p">[],</span><span class="kt">size_t</span> <span class="n">lbuf</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">changePassword</span><span class="p">(</span><span class="n">IdentityID</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">oldPwd</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">newPwd</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">changeCertificate</span><span class="p">(</span><span class="n">IdentityID</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pwd</span><span class="p">,</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cert</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">lcert</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">changeStoreIdentity</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">newIdentity</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="kt">unsigned</span>    <span class="n">getStoreID</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">unsigned</span>    <span class="n">getLocalStoreID</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">IExprTree</span>    <span class="o">*</span><span class="n">expr</span><span class="p">(</span><span class="n">ExprOp</span> <span class="n">op</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nOperands</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">operands</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">IStmt</span>        <span class="o">*</span><span class="n">createStmt</span><span class="p">(</span><span class="n">STMT_OP</span><span class="o">=</span><span class="n">STMT_QUERY</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IStmt</span>        <span class="o">*</span><span class="n">createStmt</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">queryStr</span><span class="p">,</span><span class="k">const</span> <span class="n">URIID</span> <span class="o">*</span><span class="n">ids</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nids</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">CompilationError</span> <span class="o">*</span><span class="n">ce</span><span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IExprTree</span>    <span class="o">*</span><span class="n">createExprTree</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span><span class="k">const</span> <span class="n">URIID</span> <span class="o">*</span><span class="n">ids</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nids</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">CompilationError</span> <span class="o">*</span><span class="n">ce</span><span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IExpr</span>        <span class="o">*</span><span class="n">createExpr</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span><span class="k">const</span> <span class="n">URIID</span> <span class="o">*</span><span class="n">ids</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nids</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">CompilationError</span> <span class="o">*</span><span class="n">ce</span><span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IExpr</span>        <span class="o">*</span><span class="n">createExtExpr</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">langID</span><span class="p">,</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">body</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">lBody</span><span class="p">,</span><span class="kt">uint16_t</span> <span class="n">flags</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">getTypeName</span><span class="p">(</span><span class="n">ValueType</span> <span class="n">type</span><span class="p">,</span><span class="kt">char</span> <span class="n">buf</span><span class="p">[],</span><span class="kt">size_t</span> <span class="n">lbuf</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">abortQuery</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">execute</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">lstr</span><span class="p">,</span><span class="kt">char</span> <span class="o">**</span><span class="n">result</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="k">const</span> <span class="n">URIID</span> <span class="o">*</span><span class="n">ids</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nids</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">params</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nParams</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">CompilationError</span> <span class="o">*</span><span class="n">ce</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">uint64_t</span> <span class="o">*</span><span class="n">nProcessed</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span>
                                    <span class="kt">unsigned</span> <span class="n">nProcess</span><span class="o">=~</span><span class="mi">0u</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nSkip</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">createInputStream</span><span class="p">(</span><span class="n">IStreamIn</span> <span class="o">*&amp;</span><span class="n">in</span><span class="p">,</span><span class="n">IStreamIn</span> <span class="o">*</span><span class="n">out</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">lbuf</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">getClassID</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">className</span><span class="p">,</span><span class="n">ClassID</span><span class="o">&amp;</span> <span class="n">cid</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">enableClassNotifications</span><span class="p">(</span><span class="n">ClassID</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">notifications</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">rebuildIndices</span><span class="p">(</span><span class="k">const</span> <span class="n">ClassID</span> <span class="o">*</span><span class="n">cidx</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nClasses</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">rebuildIndexFT</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">createIndexNav</span><span class="p">(</span><span class="n">ClassID</span><span class="p">,</span><span class="n">IndexNav</span> <span class="o">*&amp;</span><span class="n">nav</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">listValues</span><span class="p">(</span><span class="n">ClassID</span> <span class="n">cid</span><span class="p">,</span><span class="n">PropertyID</span> <span class="n">pid</span><span class="p">,</span><span class="n">IndexNav</span> <span class="o">*&amp;</span><span class="n">ven</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">listWords</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">query</span><span class="p">,</span><span class="n">StringEnum</span> <span class="o">*&amp;</span><span class="n">sen</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">getClassInfo</span><span class="p">(</span><span class="n">ClassID</span><span class="p">,</span><span class="n">IPIN</span><span class="o">*&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">IPIN</span>     <span class="o">*</span><span class="n">getPIN</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IPIN</span>     <span class="o">*</span><span class="n">getPIN</span><span class="p">(</span><span class="k">const</span> <span class="n">Value</span><span class="o">&amp;</span> <span class="n">ref</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IPIN</span>     <span class="o">*</span><span class="n">getPINByURI</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">uri</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">getValues</span><span class="p">(</span><span class="n">Value</span> <span class="o">*</span><span class="n">vals</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nVals</span><span class="p">,</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">getValue</span><span class="p">(</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">,</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">,</span><span class="n">PropertyID</span><span class="p">,</span><span class="n">ElementID</span><span class="o">=</span><span class="n">STORE_COLLECTION_ID</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">getValue</span><span class="p">(</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">,</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">bool</span>     <span class="n">isCached</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">createPIN</span><span class="p">(</span><span class="n">PID</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="n">values</span><span class="p">[],</span><span class="kt">unsigned</span> <span class="n">nValues</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="k">const</span> <span class="n">AllocCtrl</span><span class="o">*</span> <span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">IPIN</span>     <span class="o">*</span><span class="n">createUncommittedPIN</span><span class="p">(</span><span class="n">Value</span><span class="o">*</span> <span class="n">values</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nValues</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="k">const</span> <span class="n">PID</span> <span class="o">*</span><span class="n">original</span><span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">commitPINs</span><span class="p">(</span><span class="n">IPIN</span> <span class="o">*</span><span class="k">const</span> <span class="o">*</span><span class="n">pins</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nPins</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="k">const</span> <span class="n">AllocCtrl</span><span class="o">*</span> <span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">params</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nParams</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">modifyPIN</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span><span class="o">&amp;</span> <span class="n">id</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">values</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nValues</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="k">const</span> <span class="n">ElementID</span> <span class="o">*</span><span class="n">eids</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="o">*</span><span class="n">pNFailed</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span> <span class="o">*</span><span class="n">params</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nParams</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">deletePINs</span><span class="p">(</span><span class="n">IPIN</span> <span class="o">**</span><span class="n">pins</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nPins</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">deletePINs</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span> <span class="o">*</span><span class="n">pids</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nPids</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">undeletePINs</span><span class="p">(</span><span class="k">const</span> <span class="n">PID</span> <span class="o">*</span><span class="n">pids</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nPids</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setPINAllocationParameters</span><span class="p">(</span><span class="k">const</span> <span class="n">AllocCtrl</span> <span class="o">*</span><span class="n">ac</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setIsolationLevel</span><span class="p">(</span><span class="n">TXI_LEVEL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">startTransaction</span><span class="p">(</span><span class="n">TX_TYPE</span><span class="o">=</span><span class="n">TXT_READWRITE</span><span class="p">,</span><span class="n">TXI_LEVEL</span><span class="o">=</span><span class="n">TXI_DEFAULT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">commit</span><span class="p">(</span><span class="n">bool</span> <span class="n">fAll</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">rollback</span><span class="p">(</span><span class="n">bool</span> <span class="n">fAll</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">reservePage</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">copyValue</span><span class="p">(</span><span class="k">const</span> <span class="n">Value</span><span class="o">&amp;</span> <span class="n">src</span><span class="p">,</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">dest</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">convertValue</span><span class="p">(</span><span class="k">const</span> <span class="n">Value</span><span class="o">&amp;</span> <span class="n">oldValue</span><span class="p">,</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">newValue</span><span class="p">,</span><span class="n">ValueType</span> <span class="n">newType</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">parseValue</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">l</span><span class="p">,</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">res</span><span class="p">,</span><span class="n">CompilationError</span> <span class="o">*</span><span class="n">ce</span><span class="o">=</span><span class="nb">NULL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">parseValues</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">l</span><span class="p">,</span><span class="n">Value</span> <span class="o">*&amp;</span><span class="n">res</span><span class="p">,</span><span class="kt">unsigned</span><span class="o">&amp;</span> <span class="n">nValues</span><span class="p">,</span><span class="n">CompilationError</span> <span class="o">*</span><span class="n">ce</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="kt">char</span> <span class="n">delimiter</span><span class="o">=</span><span class="sc">&#39;,&#39;</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">int</span>         <span class="n">compareValues</span><span class="p">(</span><span class="k">const</span> <span class="n">Value</span><span class="o">&amp;</span> <span class="n">v1</span><span class="p">,</span><span class="k">const</span> <span class="n">Value</span><span class="o">&amp;</span> <span class="n">v2</span><span class="p">,</span><span class="n">bool</span> <span class="n">fNCase</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">freeValues</span><span class="p">(</span><span class="n">Value</span> <span class="o">*</span><span class="n">vals</span><span class="p">,</span><span class="kt">unsigned</span> <span class="n">nVals</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">freeValue</span><span class="p">(</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">val</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">setTimeZone</span><span class="p">(</span><span class="kt">int64_t</span> <span class="n">tzShift</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">convDateTime</span><span class="p">(</span><span class="kt">uint64_t</span> <span class="n">dt</span><span class="p">,</span><span class="n">DateTime</span><span class="o">&amp;</span> <span class="n">dts</span><span class="p">,</span><span class="n">bool</span> <span class="n">fUTC</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">convDateTime</span><span class="p">(</span><span class="k">const</span> <span class="n">DateTime</span><span class="o">&amp;</span> <span class="n">dts</span><span class="p">,</span><span class="kt">uint64_t</span><span class="o">&amp;</span> <span class="n">dt</span><span class="p">,</span><span class="n">bool</span> <span class="n">fUTC</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span> <span class="k">const</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setStopWordTable</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">words</span><span class="p">,</span><span class="kt">uint32_t</span> <span class="n">nWords</span><span class="p">,</span><span class="n">PropertyID</span> <span class="n">pid</span><span class="o">=</span><span class="n">STORE_INVALID_PROPID</span><span class="p">,</span>
                                                            <span class="n">bool</span> <span class="n">fOverwriteDefault</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="n">bool</span> <span class="n">fSessionOnly</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="o">*</span><span class="n">alloc</span><span class="p">(</span><span class="kt">size_t</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="o">*</span><span class="n">realloc</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span><span class="kt">size_t</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">free</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="n">class</span> <span class="n">MV_EXP</span> <span class="n">IConnection</span>
    <span class="p">{</span>
    <span class="nl">public:</span>
        <span class="k">static</span>   <span class="n">IConnection</span>  <span class="o">*</span><span class="n">create</span><span class="p">(</span><span class="n">MVStoreCtx</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">identityName</span><span class="o">=</span><span class="nb">NULL</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">password</span><span class="o">=</span><span class="nb">NULL</span><span class="p">);</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setURIBase</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">URIBase</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">addURIPrefix</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">URIprefix</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="kt">void</span>        <span class="n">close</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">process</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">lBuf</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">read</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="kt">size_t</span> <span class="n">lBuf</span><span class="p">,</span><span class="kt">size_t</span><span class="o">&amp;</span> <span class="n">lRead</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">setIsolationLevel</span><span class="p">(</span><span class="n">TXI_LEVEL</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">startTransaction</span><span class="p">(</span><span class="n">TX_TYPE</span><span class="o">=</span><span class="n">TXT_READWRITE</span><span class="p">,</span><span class="n">TXI_LEVEL</span><span class="o">=</span><span class="n">TXI_DEFAULT</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">commit</span><span class="p">(</span><span class="n">bool</span> <span class="n">fAll</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">virtual</span>  <span class="n">RC</span>           <span class="n">rollback</span><span class="p">(</span><span class="n">bool</span> <span class="n">fAll</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="p">};</span>
<span class="p">}</span>

<span class="cp">#endif</span>
</pre></div>
<!-- end highlighted code -->

</div>
